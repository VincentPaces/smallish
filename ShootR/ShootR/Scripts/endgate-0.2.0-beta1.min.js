function asyncLoop(n,t,i){(function r(u){u<t?n(function(){r(u+1)},u):i&&i()})(0)}var __extends=this.__extends||function(n,t){function r(){this.constructor=n}for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);r.prototype=t.prototype,n.prototype=new r},GameRunnerInstance,eg,EndGate;(function(n){var t=function(){function n(t,i,r){typeof i=="undefined"&&(i=0),typeof r=="undefined"&&(r=0),this._type="TimeSpan",this.Milliseconds=t+i*n._secondsMultiplier+r*n._minutesMultiplier}return Object.defineProperty(n.prototype,"Milliseconds",{get:function(){return this._milliseconds},set:function(t){this._milliseconds=t,this._seconds=t/n._secondsMultiplier,this._minutes=t/n._minutesMultiplier},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"Seconds",{get:function(){return this._seconds},set:function(t){this._seconds=t,this._milliseconds=t*n._secondsMultiplier,this._minutes=this._milliseconds/n._minutesMultiplier},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"Minutes",{get:function(){return this._minutes},set:function(t){this._minutes=t,this._seconds=t*60,this._milliseconds=this._seconds*n._secondsMultiplier},enumerable:!0,configurable:!0}),n.prototype.Add=function(t){return t._type==="TimeSpan"?new n(this.Milliseconds+t.Milliseconds):new n(this.Milliseconds+t)},n.prototype.Multiply=function(t){return t._type==="TimeSpan"?new n(this.Milliseconds*t.Milliseconds):new n(this.Milliseconds*t)},n.prototype.Subtract=function(t){return t._type==="TimeSpan"?new n(this.Milliseconds-t.Milliseconds):new n(this.Milliseconds-t)},n.prototype.SubtractFrom=function(t){return t._type==="TimeSpan"?new n(t.Milliseconds-this.Milliseconds):new n(t-this.Milliseconds)},n.prototype.Divide=function(t){return t._type==="TimeSpan"?new n(this.Milliseconds/t.Milliseconds):new n(this.Milliseconds/t)},n.prototype.DivideFrom=function(t){return t._type==="TimeSpan"?new n(t.Milliseconds/this.Milliseconds):new n(t/this.Milliseconds)},n.prototype.Equivalent=function(n){return this.Milliseconds===n.Milliseconds},n.prototype.Clone=function(){return new n(this.Milliseconds)},n.prototype.toString=function(){return this.Milliseconds+":"+this.Seconds+":"+this.Minutes},n.FromMilliseconds=function(t){return new n(t)},n.FromSeconds=function(t){return new n(0,t)},n.FromMinutes=function(t){return new n(0,0,t)},n.DateSpan=function(t,i){return new n(i.getTime()-t.getTime())},Object.defineProperty(n,"Zero",{get:function(){return new n(0)},enumerable:!0,configurable:!0}),n._secondsMultiplier=1e3,n._minutesMultiplier=n._secondsMultiplier*60,n}();n.TimeSpan=t})(EndGate||(EndGate={})),function(n){var t=function(){function t(){this._type="GameTime",this._start=this._lastUpdate=new Date,this.Update()}return Object.defineProperty(t.prototype,"Elapsed",{get:function(){return this._elapsed},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Now",{get:function(){return this._lastUpdate},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Total",{get:function(){return n.TimeSpan.DateSpan(this._start,new Date)},enumerable:!0,configurable:!0}),t.prototype.Update=function(){var t=new Date;this._elapsed=new n.TimeSpan(t.getTime()-this._lastUpdate.getTime()),this._lastUpdate=t},t}();n.GameTime=t}(EndGate||(EndGate={})),function(n){var t=function(){function n(n,t){this._type="Size2d",this.Width=n||0,this.Height=typeof t!="undefined"?t:this.Width}return Object.defineProperty(n,"Zero",{get:function(){return new n(0,0)},enumerable:!0,configurable:!0}),Object.defineProperty(n,"One",{get:function(){return new n(1,1)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"Radius",{get:function(){return.5*Math.sqrt(this.Width*this.Width+this.Height*this.Height)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"HalfWidth",{get:function(){return this.Width/2},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"HalfHeight",{get:function(){return this.Height/2},enumerable:!0,configurable:!0}),n.prototype.Apply=function(n){this.Width=n(this.Width),this.Height=n(this.Height)},n.prototype.Trigger=function(n){n(this.Width),n(this.Height)},n.prototype.Add=function(t){return t._type==="Size2d"?new n(this.Width+t.Width,this.Height+t.Height):t._type==="Vector2d"?new n(this.Width+t.X,this.Height+t.Y):new n(this.Width+t,this.Height+t)},n.prototype.Multiply=function(t){return t._type==="Size2d"?new n(this.Width*t.Width,this.Height*t.Height):t._type==="Vector2d"?new n(this.Width*t.X,this.Height*t.Y):new n(this.Width*t,this.Height*t)},n.prototype.Subtract=function(t){return t._type==="Size2d"?new n(this.Width-t.Width,this.Height-t.Height):t._type==="Vector2d"?new n(this.Width-t.X,this.Height-t.Y):new n(this.Width-t,this.Height-t)},n.prototype.SubtractFrom=function(t){return t._type==="Size2d"?new n(t.Width-this.Width,t.Height-this.Height):t._type==="Vector2d"?new n(t.X-this.Width,t.Y-this.Height):new n(t-this.Width,t-this.Height)},n.prototype.Divide=function(t){return t._type==="Size2d"?new n(this.Width/t.Width,this.Height/t.Height):t._type==="Vector2d"?new n(this.Width/t.X,this.Height/t.Y):new n(this.Width/t,this.Height/t)},n.prototype.DivideFrom=function(t){return t._type==="Size2d"?new n(t.Width/this.Width,t.Height/this.Height):t._type==="Vector2d"?new n(t.X/this.Width,t.Y/this.Height):new n(t/this.Width,t/this.Height)},n.prototype.Negate=function(){return new n(this.Width*-1,this.Height*-1)},n.prototype.Equivalent=function(n){return this.Width===n.Width&&this.Height===n.Height},n.prototype.Clone=function(){return new n(this.Width,this.Height)},n.prototype.toString=function(){return"("+this.Width+", "+this.Height+")"},n}();n.Size2d=t}(EndGate||(EndGate={})),Math.roundTo=function(n,t){var i=Math.pow(10,t);return Math.round(n*i)/i},Math.twoPI=Math.PI*2,function(n){var t=function(){function n(n,t){this._type="Vector2d",this.X=n||0,this.Y=t||0}return Object.defineProperty(n,"Zero",{get:function(){return new n(0,0)},enumerable:!0,configurable:!0}),Object.defineProperty(n,"One",{get:function(){return new n(1,1)},enumerable:!0,configurable:!0}),n.prototype.Reflect=function(t){var i=t.Unit(),r=this.Dot(i)*2;return new n(this.X-r*i.X,this.Y-r*i.Y)},n.prototype.ProjectOnto=function(n){return n.Multiply(this.Dot(n)/n.Dot(n))},n.prototype.RotateAround=function(t,i,r){typeof r=="undefined"&&(r=2);var u=Math.cos(i),f=Math.sin(i);return new n(Math.roundTo(u*(this.X-t.X)-f*(this.Y-t.Y)+t.X,r),Math.roundTo(f*(this.X-t.X)+u*(this.Y-t.Y)+t.Y,r))},n.prototype.Apply=function(n){this.X=n(this.X),this.Y=n(this.Y)},n.prototype.Trigger=function(n){n(this.X),n(this.Y)},n.prototype.Normalized=function(){var t=this.Magnitude();return new n(this.X/t,this.Y/t)},n.prototype.Magnitude=function(){return Math.sqrt(this.X*this.X+this.Y*this.Y)},n.prototype.Length=function(){return this.Magnitude()},n.prototype.Dot=function(n){return n.X*this.X+n.Y*this.Y},n.prototype.Abs=function(){return new n(Math.abs(this.X),Math.abs(this.Y))},n.prototype.Sign=function(){return new n(this.X/Math.abs(this.X),this.Y/Math.abs(this.Y))},n.prototype.Unit=function(){var t=this.Magnitude();return new n(this.X/t,this.Y/t)},n.prototype.Distance=function(t){return new n(Math.abs(t.X-this.X),Math.abs(t.Y-this.Y))},n.prototype.Add=function(t){return t._type==="Vector2d"?new n(this.X+t.X,this.Y+t.Y):t._type==="Size2d"?new n(this.X+t.Width,this.Y+t.Height):new n(this.X+t,this.Y+t)},n.prototype.Multiply=function(t){return t._type==="Vector2d"?new n(this.X*t.X,this.Y*t.Y):t._type==="Size2d"?new n(this.X*t.Width,this.Y*t.Height):new n(this.X*t,this.Y*t)},n.prototype.Subtract=function(t){return t._type==="Vector2d"?new n(this.X-t.X,this.Y-t.Y):t._type==="Size2d"?new n(this.X-t.Width,this.Y-t.Height):new n(this.X-t,this.Y-t)},n.prototype.SubtractFrom=function(t){return t._type==="Vector2d"?new n(t.X-this.X,t.Y-this.Y):t._type==="Size2d"?new n(t.Width-this.X,t.Height=this.Y):new n(t-this.X,t-this.Y)},n.prototype.Divide=function(t){return t._type==="Vector2d"?new n(this.X/t.X,this.Y/t.Y):t._type==="Size2d"?new n(this.X/t.Width,this.Y/t.Height):new n(this.X/t,this.Y/t)},n.prototype.DivideFrom=function(t){return t._type==="Vector2d"?new n(t.X/this.X,t.Y/this.Y):t._type==="Size2d"?new n(t.Width/this.X,t.Height/this.Y):new n(t/this.X,t/this.Y)},n.prototype.IsZero=function(){return this.X===0&&this.Y===0},n.prototype.Negate=function(){return new n(this.X*-1,this.Y*-1)},n.prototype.Equivalent=function(n){return this.X===n.X&&this.Y===n.Y},n.prototype.Clone=function(){return new n(this.X,this.Y)},n.prototype.toString=function(){return"("+this.X+", "+this.Y+")"},n}();n.Vector2d=t}(EndGate||(EndGate={})),function(n){(function(n){var t=function(){function n(n,t){this._boundsType="Bounds2d",this.Position=n,this.Rotation=t||0}return n.prototype.Scale=function(){throw new Error("This method is abstract!");},n.prototype.ContainsPoint=function(){throw new Error("This method is abstract!");},n.prototype.ContainsCircle=function(){throw new Error("This method is abstract!");},n.prototype.ContainsRectangle=function(){throw new Error("This method is abstract!");},n.prototype.Contains=function(n){if(n._boundsType==="BoundingCircle")return this.ContainsCircle(n);if(n._boundsType==="BoundingRectangle")return this.ContainsRectangle(n);if(n._type==="Vector2d")return this.ContainsPoint(n);throw new Error("Cannot try and check contains with an unidentifiable object, must be a Vector2d, BoundingCircle or BoundingRectangle.");},n.prototype.Intersects=function(n){if(n._boundsType==="BoundingCircle")return this.IntersectsCircle(n);if(n._boundsType==="BoundingRectangle")return this.IntersectsRectangle(n);throw new Error("Cannot intersect with unidentifiable object, must be BoundingCircle or BoundingRectangle.");},n.prototype.IntersectsCircle=function(){throw new Error("This method is abstract!");},n.prototype.IntersectsRectangle=function(){throw new Error("This method is abstract!");},n}();n.Bounds2d=t})(n.Bounds||(n.Bounds={}));var t=n.Bounds}(EndGate||(EndGate={})),function(n){(function(n){(function(n){var t=function(){function n(t){this._type="LooperCallback",this.Callback=t,this.ID=n._ids++}return n._ids=0,n}();n.LooperCallback=t})(n.Loopers||(n.Loopers={}));var t=n.Loopers})(n._||(n._={}));var t=n._}(EndGate||(EndGate={})),function(n){(function(n){(function(n){var t=function(n){function t(t,i){n.call(this,i),this._type="TimedCallback",this.Fps=t,this.TimeoutID=0,this.Active=!1}return __extends(t,n),t}(n.LooperCallback);n.TimedCallback=t})(n.Loopers||(n.Loopers={}));var t=n.Loopers})(n._||(n._={}));var t=n._}(EndGate||(EndGate={})),function(n){(function(n){(function(n){var t=function(){function n(){this._type="Looper",this._running=!1,this._callbacks=[]}return n.prototype.AddCallback=function(n){var t=this;this._callbacks.push(n),n.Active=!0,this._running&&window.setTimeout(function(){t.Loop(n)},0)},n.prototype.RemoveCallback=function(n){for(var t=0;t<this._callbacks.length;t++)if(this._callbacks[t].ID===n.ID){window.clearTimeout(n.TimeoutID),n.Active=!1,this._callbacks.splice(t,1);return}},n.prototype.Start=function(){this._running=!0,this.Run()},n.prototype.Run=function(){for(var t=this,n=0;n<this._callbacks.length;n++)window.setTimeout(function(n){return function(){t.Loop(t._callbacks[n])}}(n),0)},n.prototype.Loop=function(n){var t=this,i=1e3/n.Fps;n.Callback(),n.Active&&(n.TimeoutID=window.setTimeout(function(){t.Loop(n)},i))},n.prototype.Dispose=function(){for(var n=this._callbacks.length-1;n>=0;n--)this.RemoveCallback(this._callbacks[n]);this._callbacks=[],this._running=!1},n}();n.Looper=t})(n.Loopers||(n.Loopers={}));var t=n.Loopers})(n._||(n._={}));var t=n._}(EndGate||(EndGate={})),window.OnRepaintCompleted=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(n){window.setTimeout(n,0)}}(),function(n){(function(n){(function(n){var t=function(){function n(){this._type="RepaintLooper",this._running=!1,this._callbacksModified=!1,this._callbacks=[]}return n.prototype.Start=function(){this._running=!0,this.Run()},n.prototype.Run=function(){var t=this,n;if(this._running){for(this._callbacksModified=!1,n=0;n<this._callbacks.length;n++)if(this._callbacks[n].Callback(),this._callbacksModified)break;window.OnRepaintCompleted(function(){t.Run()})}},n.prototype.AddCallback=function(n){this._callbacksModified=!0,this._callbacks.push(n)},n.prototype.RemoveCallback=function(n){for(var t=0;t<this._callbacks.length;t++)if(this._callbacks[t].ID===n.ID){this._callbacksModified=!0,this._callbacks.splice(t,1);return}},n.prototype.Dispose=function(){this._callbacksModified=!0,this._callbacks=[],this._running=!1},n}();n.RepaintLooper=t})(n.Loopers||(n.Loopers={}));var t=n.Loopers})(n._||(n._={}));var t=n._}(EndGate||(EndGate={})),function(n){(function(n){var t=function(){function t(){this._type="GameRunner",this._updateCallbacks={},this._drawCallbacks={},this._updateLoop=null,this._drawLoop=null,this._callbackCount=0}return t.prototype.Register=function(n){var t=this.CreateAndCacheUpdateCallback(n),i=this.CreateAndCacheDrawCallback(n);return this._callbackCount++,this.TryLoopStart(),this._updateLoop.AddCallback(t),this._drawLoop.AddCallback(i),this.CreateUpdateRateSetter(t)},t.prototype.Unregister=function(n){var t,i;this._updateCallbacks[n._ID]&&(t=this._updateCallbacks[n._ID],i=this._drawCallbacks[n._ID],this._updateLoop.RemoveCallback(t),this._drawLoop.RemoveCallback(i),delete this._updateCallbacks[n._ID],delete this._drawCallbacks[n._ID],this._callbackCount--,this.TryLoopStop())},t.prototype.TryLoopStart=function(){this._callbackCount===1&&(this._updateLoop=new n.Loopers.Looper,this._updateLoop.Start(),this._drawLoop=new n.Loopers.RepaintLooper,this._drawLoop.Start())},t.prototype.TryLoopStop=function(){this._callbackCount===0&&this._updateLoop!=null&&(this._updateLoop.Dispose(),this._updateLoop=null,this._drawLoop.Dispose(),this._drawLoop=null)},t.prototype.CreateAndCacheUpdateCallback=function(t){var i=new n.Loopers.TimedCallback(0,function(){t._PrepareUpdate()});return this._updateCallbacks[t._ID]=i,i},t.prototype.CreateAndCacheDrawCallback=function(t){var i=new n.Loopers.LooperCallback(function(){t._PrepareDraw()});return this._drawCallbacks[t._ID]=i,i},t.prototype.CreateUpdateRateSetter=function(n){return function(t){n.Fps=t}},t}();n.GameRunner=t})(n._||(n._={}));var t=n._}(EndGate||(EndGate={})),GameRunnerInstance=new EndGate._.GameRunner,function(n){var t=function(){function n(){this._type="EventHandler",this._actions=[]}return n.prototype.Bind=function(n){this._actions.push(n)},n.prototype.BindFor=function(n,t){var i=this,r=0;this._actions.push(function(){++r>=t&&i.Unbind(n),n.apply(this,arguments)})},n.prototype.Unbind=function(n){for(var t=0;t<this._actions.length;t++)if(this._actions[t]===n){this._actions.splice(t,1);return}},n.prototype.HasBindings=function(){return this._actions.length>0},n.prototype.Trigger=function(){var t,n;if(this.HasBindings())for(t=this._actions.slice(0),n=0;n<t.length;n++)t[n]()},n.prototype.Dispose=function(){this._actions=[]},n}();n.EventHandler=t}(EndGate||(EndGate={})),function(n){(function(t){var i=function(){function t(i){this._initialQuadTreeSize=i,this._minQuadTreeNodeSize=t._DefaultMinQuadTreeNodeSize,this._OnChange=new n.EventHandler}return Object.defineProperty(t.prototype,"MinQuadTreeNodeSize",{get:function(){return this._minQuadTreeNodeSize.Clone()},set:function(n){if(n.Width!==n.Height)throw new Error("MinQuadTreeNodeSize must be a square.  Width and height must be identical.");this._minQuadTreeNodeSize=n,this._OnChange.Trigger()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"InitialQuadTreeSize",{get:function(){return this._initialQuadTreeSize},set:function(n){if(n.Width!==n.Height)throw new Error("InitialQuadTreeSize must be a square.  Width and height must be identical.");else if(n.Width%this._minQuadTreeNodeSize.Width!=0)throw new Error("InitialQuadTreeSize must be divisible by the MinQuadTreeNodeSize.");this._initialQuadTreeSize=n,this._OnChange.Trigger()},enumerable:!0,configurable:!0}),t._DefaultMinQuadTreeNodeSize=new n.Size2d(32),t}();t.CollisionConfiguration=i})(n.Collision||(n.Collision={}));var t=n.Collision}(EndGate||(EndGate={})),function(n){var t=function(){function t(t,i){this._defaultUpdateRate=40,this.DrawOnlyAfterUpdate=!0,this._updateRateSetter=t,this._updateRate=this._defaultUpdateRate,this._collisionConfiguration=new n.Collision.CollisionConfiguration(i)}return Object.defineProperty(t.prototype,"UpdateRate",{get:function(){return this._updateRate},set:function(n){this._updateRate=n,this._updateRateSetter(this._updateRate)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"CollisionConfiguration",{get:function(){return this._collisionConfiguration},enumerable:!0,configurable:!0}),t}();n.GameConfiguration=t}(EndGate||(EndGate={})),function(n){(function(n){var t=function(){function n(n,t){this.Min=n,this.Max=t}return n}();n.MinMax=t})(n._||(n._={}));var t=n._}(EndGate||(EndGate={})),function(n){(function(n){var t=function(){function t(){}return t.GetMinMaxProjections=function(t,i){for(var u=i[0].ProjectOnto(t).Dot(t),e=u,o,r,f=1;f<i.length;f++)o=i[f],r=o.ProjectOnto(t).Dot(t),r<u?u=r:r>e&&(e=r);return new n.MinMax(u,e)},t}();n.Vector2dHelpers=t})(n._||(n._={}));var t=n._}(EndGate||(EndGate={})),function(n){(function(n){var t=function(n){function t(t,i){n.call(this,t),this._type="BoundingCircle",this._boundsType="BoundingCircle",this.Radius=i}return __extends(t,n),t.prototype.Scale=function(n){this.Radius*=n},t.prototype.Area=function(){return Math.PI*this.Radius*this.Radius},t.prototype.Circumference=function(){return 2*Math.PI*this.Radius},t.prototype.IntersectsCircle=function(n){return this.Position.Distance(n.Position).Length()<this.Radius+n.Radius},t.prototype.IntersectsRectangle=function(n){var r=n.Rotation===0?this.Position:this.Position.RotateAround(n.Position,-n.Rotation),t=r.Distance(n.Position),i;return t.X>n.Size.HalfWidth+this.Radius?!1:t.Y>n.Size.HalfHeight+this.Radius?!1:t.X<=n.Size.HalfWidth?!0:t.Y<=n.Size.HalfHeight?!0:(i=Math.pow(t.X-n.Size.HalfWidth,2)+Math.pow(t.Y-n.Size.HalfHeight,2),i<=this.Radius*this.Radius)},t.prototype.ContainsPoint=function(n){return this.Position.Distance(n).Magnitude()<this.Radius},t.prototype.ContainsCircle=function(n){return n.Position.Distance(this.Position).Length()+n.Radius<=this.Radius},t.prototype.ContainsRectangle=function(n){for(var i=n.Corners(),t=0;t<i.length;t++)if(!this.ContainsPoint(i[t]))return!1;return!0},t}(n.Bounds2d);n.BoundingCircle=t})(n.Bounds||(n.Bounds={}));var t=n.Bounds}(EndGate||(EndGate={})),function(n){(function(t){var i=function(t){function i(n,i){t.call(this,n),this._type="BoundingRectangle",this._boundsType="BoundingRectangle",this.Size=i}return __extends(i,t),i.prototype.Scale=function(n,t){this.Size.Width*=n,this.Size.Height*=t},Object.defineProperty(i.prototype,"TopLeft",{get:function(){return this.Rotation===0?new n.Vector2d(this.Position.X-this.Size.HalfWidth,this.Position.Y-this.Size.HalfHeight):new n.Vector2d(this.Position.X-this.Size.HalfWidth,this.Position.Y-this.Size.HalfHeight).RotateAround(this.Position,this.Rotation)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"TopRight",{get:function(){return this.Rotation===0?new n.Vector2d(this.Position.X+this.Size.HalfWidth,this.Position.Y-this.Size.HalfHeight):new n.Vector2d(this.Position.X+this.Size.HalfWidth,this.Position.Y-this.Size.HalfHeight).RotateAround(this.Position,this.Rotation)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"BotLeft",{get:function(){return this.Rotation===0?new n.Vector2d(this.Position.X-this.Size.HalfWidth,this.Position.Y+this.Size.HalfHeight):new n.Vector2d(this.Position.X-this.Size.HalfWidth,this.Position.Y+this.Size.HalfHeight).RotateAround(this.Position,this.Rotation)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"BotRight",{get:function(){return this.Rotation===0?new n.Vector2d(this.Position.X+this.Size.HalfWidth,this.Position.Y+this.Size.HalfHeight):new n.Vector2d(this.Position.X+this.Size.HalfWidth,this.Position.Y+this.Size.HalfHeight).RotateAround(this.Position,this.Rotation)},enumerable:!0,configurable:!0}),i.prototype.Corners=function(){return[this.TopLeft,this.TopRight,this.BotLeft,this.BotRight]},i.prototype.IntersectsCircle=function(n){return n.IntersectsRectangle(this)},i.prototype.IntersectsRectangle=function(t){var i;if(this.Rotation===0&&t.Rotation===0){var r=this.TopLeft,u=this.BotRight,f=t.TopLeft,e=t.BotRight;return f.X<=u.X&&e.X>=r.X&&f.Y<=u.Y&&e.Y>=r.Y}if(t.Position.Distance(this.Position).Magnitude()<=t.Size.Radius+this.Size.Radius){var o=[this.TopRight.Subtract(this.TopLeft),this.TopRight.Subtract(this.BotRight),t.TopLeft.Subtract(t.BotLeft),t.TopLeft.Subtract(t.TopRight)],l=this.Corners(),a=t.Corners();for(i=0;i<o.length;i++){var s=o[i],h=n._.Vector2dHelpers.GetMinMaxProjections(s,l),c=n._.Vector2dHelpers.GetMinMaxProjections(s,a);if(c.Max<h.Min||h.Max<c.Min)return!1}return!0}return!1},i.prototype.ContainsPoint=function(n){var r=this.Rotation,t,i;return this.Rotation!==0&&(this.Rotation=0,n=n.RotateAround(this.Position,-r)),t=this.TopLeft,i=this.BotRight,this.Rotation=r,n.X<=i.X&&n.X>=t.X&&n.Y<=i.Y&&n.Y>=t.Y},i.prototype.ContainsCircle=function(t){return this.ContainsPoint(new n.Vector2d(t.Position.X-t.Radius,t.Position.Y))&&this.ContainsPoint(new n.Vector2d(t.Position.X,t.Position.Y-t.Radius))&&this.ContainsPoint(new n.Vector2d(t.Position.X+t.Radius,t.Position.Y))&&this.ContainsPoint(new n.Vector2d(t.Position.X,t.Position.Y+t.Radius))},i.prototype.ContainsRectangle=function(n){for(var i=n.Corners(),t=0;t<i.length;t++)if(!this.ContainsPoint(i[t]))return!1;return!0},i}(t.Bounds2d);t.BoundingRectangle=i})(n.Bounds||(n.Bounds={}));var t=n.Bounds}(EndGate||(EndGate={})),function(n){var t=function(){function n(){this._type="EventHandler1",this._actions=[]}return n.prototype.Bind=function(n){this._actions.push(n)},n.prototype.BindFor=function(n,t){var i=this,r=0;this._actions.push(function(){++r>=t&&i.Unbind(n),n.apply(this,arguments)})},n.prototype.Unbind=function(n){for(var t=0;t<this._actions.length;t++)if(this._actions[t]===n){this._actions.splice(t,1);return}},n.prototype.HasBindings=function(){return this._actions.length>0},n.prototype.Trigger=function(n){var i,t;if(this.HasBindings())for(i=this._actions.slice(0),t=0;t<i.length;t++)i[t](n)},n.prototype.Dispose=function(){this._actions=[]},n}();n.EventHandler1=t}(EndGate||(EndGate={})),function(n){(function(n){var t=function(){function n(n){this.With=n}return n}();n.CollisionData=t})(n.Collision||(n.Collision={}));var t=n.Collision}(EndGate||(EndGate={})),function(n){(function(t){var i=function(){function t(i){this._type="Collidable",this._disposed=!1,this.Bounds=i,this._id=t._collidableIDs++,this._onCollision=new n.EventHandler1,this._onDisposed=new n.EventHandler1}return Object.defineProperty(t.prototype,"OnCollision",{get:function(){return this._onCollision},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"OnDisposed",{get:function(){return this._onDisposed},enumerable:!0,configurable:!0}),t.prototype.IsCollidingWith=function(n){return this.Bounds.Intersects(n.Bounds)},t.prototype.Collided=function(n){this.OnCollision.Trigger(n)},t.prototype.Dispose=function(){if(this._disposed)throw new Error("Cannot dispose collidable more than once.");else this._disposed=!0,this.OnDisposed.Trigger(this),this.OnDisposed.Dispose(),this.OnCollision.Dispose()},t._collidableIDs=0,t}();t.Collidable=i})(n.Collision||(n.Collision={}));var t=n.Collision}(EndGate||(EndGate={})),function(n){(function(t){(function(i){(function(i){var r=function(t){function i(i,r,u,f){t.call(this,new n.Bounds.BoundingRectangle(i,r)),this._minNodeSize=u,this._children=[],this.Contents=[],this.Parent=f,this._partitioned=!1}return __extends(i,t),Object.defineProperty(i.prototype,"Children",{get:function(){return this._children},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"TopLeftChild",{get:function(){return this._children[0]},set:function(n){this._children[0]=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"TopRightChild",{get:function(){return this._children[1]},set:function(n){this._children[1]=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"BotLeftChild",{get:function(){return this._children[2]},set:function(n){this._children[2]=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"BotRightChild",{get:function(){return this._children[3]},set:function(n){this._children[3]=n},enumerable:!0,configurable:!0}),i.prototype.IsPartitioned=function(){return this._partitioned},i.prototype.Partition=function(){var t=new n.Size2d(Math.round(this.Bounds.Size.Width*.5)),r=this.Bounds.Position;(this._partitioned=!0,t.Width<this._minNodeSize.Width)||(this._children.push(new i(r.Subtract(t.Multiply(.5)),t,this._minNodeSize,this)),this._children.push(new i(new n.Vector2d(r.X+t.Width/2,r.Y-t.Height/2),t,this._minNodeSize,this)),this._children.push(new i(new n.Vector2d(r.X-t.Width/2,r.Y+t.Height/2),t,this._minNodeSize,this)),this._children.push(new i(r.Add(t.Multiply(.5)),t,this._minNodeSize,this)))},i.prototype.Insert=function(n){this._partitioned||this.Partition();for(var t=0;t<this._children.length;t++)if(this._children[t].Bounds.Contains(n.Bounds))return this._children[t].Insert(n);return this.Contents.push(n),this},i.prototype.ReverseInsert=function(n){return!this.Bounds.Contains(n.Bounds)&&this.Parent!=null?this.Parent.ReverseInsert(n):this.Insert(n)},i.prototype.Query=function(n){for(var i=[],r,t=0;t<this.Contents.length;t++)n.Intersects(this.Contents[t].Bounds)&&i.push(this.Contents[t]);for(t=0;t<this._children.length;t++){if(r=this._children[t],r.Bounds.Contains(n)){i=i.concat(r.Query(n));break}if(n.Contains(r.Bounds)){i=i.concat(r.GetSubTreeContents());continue}r.Bounds.Intersects(n)&&(i=i.concat(r.Query(n)))}return i},i.prototype.Remove=function(n){var t=this.Contents.indexOf(n);t>=0&&this.Contents.splice(t,1)},i.prototype.GetSubTreeContents=function(){for(var t=[],n=0;n<this._children.length;n++)t=t.concat(this._children[n].GetSubTreeContents());return t.concat(this.Contents)},i}(t.Collidable);i.QuadTreeNode=r})(i._||(i._={}));var r=i._})(t.Assets||(t.Assets={}));var i=t.Assets})(n.Collision||(n.Collision={}));var t=n.Collision}(EndGate||(EndGate={})),function(n){(function(t){(function(t){(function(t){var i=function(){function i(i){this._disposed=!1,this._minNodeSize=i.MinQuadTreeNodeSize,this._collidableMap={},this._updateableCollidableMap={},this._root=new t.QuadTreeNode(new n.Vector2d(i.InitialQuadTreeSize.HalfWidth,i.InitialQuadTreeSize.HalfHeight),i.InitialQuadTreeSize,i.MinQuadTreeNodeSize,null)}return i.prototype.Insert=function(n,t){typeof t=="undefined"&&(t=!1),this._root.Bounds.Contains(n.Bounds)||this.Expand(n),this._collidableMap[n._id]={Node:this._root.Insert(n),Collidable:n,StaticPosition:t},t||(this._updateableCollidableMap[n._id]=this._collidableMap[n._id])},i.prototype.Remove=function(n){var t=this._collidableMap[n._id].Node;delete this._collidableMap[n._id],delete this._updateableCollidableMap[n._id],t.Remove(n)},i.prototype.CollisionCandidates=function(n){for(var t=this._collidableMap[n._id].Node,i=t.GetSubTreeContents();t.Parent!==null;)i=i.concat(t.Parent.Contents),t=t.Parent;return i},i.prototype.Query=function(n){return this._root.Query(n)},i.prototype.Expand=function(n){var r=this._root.Bounds,e=r.TopLeft.Distance(n.Bounds.Position).Length(),o=r.TopRight.Distance(n.Bounds.Position).Length(),s=r.BotLeft.Distance(n.Bounds.Position).Length(),h=r.BotRight.Distance(n.Bounds.Position).Length(),u=Math.min(e,o,s,h),f=r.Size.Multiply(2),i;u===e?(i=new t.QuadTreeNode(r.TopLeft,f,this._minNodeSize,null),i.Partition(),i.BotRightChild=this._root):u===o?(i=new t.QuadTreeNode(r.TopRight,f,this._minNodeSize,null),i.Partition(),i.BotLeftChild=this._root):u===s?(i=new t.QuadTreeNode(r.BotLeft,f,this._minNodeSize,null),i.Partition(),i.TopRightChild=this._root):u===h&&(i=new t.QuadTreeNode(r.BotRight,f,this._minNodeSize,null),i.Partition(),i.TopLeftChild=this._root),this._root.Parent=i,this._root=i},i.prototype.Update=function(){var t,i,n,r,u;for(u in this._updateableCollidableMap)i=this._updateableCollidableMap[u],t=i.Node,n=i.Collidable,t.Remove(n),this._root.Bounds.Contains(n.Bounds)?r=t.Bounds.Contains(n.Bounds)||t.Parent==null?t.Insert(n):t.Parent.ReverseInsert(n):(this.Expand(n),r=this._root.Insert(n)),this._updateableCollidableMap[u].Node=r},i.prototype.Dispose=function(){if(this._disposed)throw new Error("Cannot dispose collidable more than once.");else this._disposed=!0},i}();t.QuadTree=i})(t._||(t._={}));var i=t._})(t.Assets||(t.Assets={}));var i=t.Assets})(n.Collision||(n.Collision={}));var t=n.Collision}(EndGate||(EndGate={})),function(n){var t=function(){function n(){this._type="EventHandler2",this._actions=[]}return n.prototype.Bind=function(n){this._actions.push(n)},n.prototype.BindFor=function(n,t){var i=this,r=0;this._actions.push(function(){++r>=t&&i.Unbind(n),n.apply(this,arguments)})},n.prototype.Unbind=function(n){for(var t=0;t<this._actions.length;t++)if(this._actions[t]===n){this._actions.splice(t,1);return}},n.prototype.HasBindings=function(){return this._actions.length>0},n.prototype.Trigger=function(n,t){var r,i;if(this.HasBindings())for(r=this._actions.slice(0),i=0;i<r.length;i++)r[i](n,t)},n.prototype.Dispose=function(){this._actions=[]},n}();n.EventHandler2=t}(EndGate||(EndGate={})),function(n){(function(t){var i=function(){function i(i){this._type="CollisionManager",this._collidables=[],this._nonStaticCollidables=[],this._quadTree=new t.Assets._.QuadTree(i),this._enabled=!1,this._disposed=!1,this._onCollision=new n.EventHandler2}return Object.defineProperty(i.prototype,"OnCollision",{get:function(){return this._onCollision},enumerable:!0,configurable:!0}),i.prototype.Monitor=function(n,t){typeof t=="undefined"&&(t=!1);var r=this,i={Collidable:n,Unmonitor:function(n){r.Unmonitor(n)}};this._enabled=!0,n.OnDisposed.Bind(i.Unmonitor),this._collidables.push(i),t||this._nonStaticCollidables.push(n),this._quadTree.Insert(n)},i.prototype.Unmonitor=function(n){for(var i,t=0;t<this._collidables.length;t++)if(this._collidables[t].Collidable._id===n._id){this._collidables[t].Collidable.OnDisposed.Unbind(this._collidables[t].Unmonitor),this._collidables.splice(t,1);break}i=this._nonStaticCollidables.indexOf(n),i>=0&&this._nonStaticCollidables.splice(i,1),this._quadTree.Remove(n)},i.prototype.Update=function(n){var f,o,e,s={},r=[],u,i;if(this._enabled){for(this._quadTree.Update(n),i=0;i<this._nonStaticCollidables.length;i++)for(f=this._nonStaticCollidables[i],e=this._quadTree.CollisionCandidates(f),u=0;u<e.length;u++)f._id!==e[u]._id&&f.IsCollidingWith(e[u])&&r.push([f,e[u]]);for(i=0;i<r.length;i++)o=this.HashIds(r[i][0],r[i][1]),s[o]||(s[o]=!0,r[i][0].Collided(new t.CollisionData(r[i][1])),r[i][1].Collided(new t.CollisionData(r[i][0])),this.OnCollision.Trigger(r[i][0],r[i][1]))}},i.prototype.Dispose=function(){if(this._disposed)throw new Error("CollisionManager cannot be disposed more than once");else{this._disposed=!0;for(var n=0;n<this._collidables.length;n++)this.Unmonitor(this._collidables[n].Collidable);this._collidables=[],this._nonStaticCollidables=[],this._onCollision.Dispose(),this._quadTree=null}},i.prototype.HashIds=function(n,t){return Math.min(n._id,t._id).toString()+Math.max(t._id,n._id).toString()},i}();t.CollisionManager=i})(n.Collision||(n.Collision={}));var t=n.Collision}(EndGate||(EndGate={})),function(n){(function(n){(function(n){(function(n){var t=function(){function n(){this._cachedState={}}return Object.defineProperty(n.prototype,"StrokeStyle",{get:function(){return this._cachedState.strokeStyle},set:function(n){this._cachedState.strokeStyle=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"FillStyle",{get:function(){return this._cachedState.fillStyle},set:function(n){this._cachedState.fillStyle=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"GlobalAlpha",{get:function(){return this._cachedState.globalAlpha},set:function(n){this._cachedState.globalAlpha=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"LineWidth",{get:function(){return this._cachedState.lineWidth},set:function(n){this._cachedState.lineWidth=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"LineCap",{get:function(){return this._cachedState.lineCap},set:function(n){this._cachedState.lineCap=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"LineJoin",{get:function(){return this._cachedState.lineJoin},set:function(n){this._cachedState.lineJoin=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"MiterLimit",{get:function(){return this._cachedState.miterLimit},set:function(n){this._cachedState.miterLimit=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"ShadowOffsetX",{get:function(){return this._cachedState.shadowOffsetX},set:function(n){this._cachedState.shadowOffsetX=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"ShadowOffsetY",{get:function(){return this._cachedState.shadowOffsetY},set:function(n){this._cachedState.shadowOffsetY=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"ShadowBlur",{get:function(){return this._cachedState.shadowBlur},set:function(n){this._cachedState.shadowBlur=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"ShadowColor",{get:function(){return this._cachedState.shadowColor},set:function(n){this._cachedState.shadowColor=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"GlobalCompositeOperation",{get:function(){return this._cachedState.globalCompositeOperation},set:function(n){this._cachedState.globalCompositeOperation=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"Font",{get:function(){return this._cachedState.font},set:function(n){this._cachedState.font=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"TextAlign",{get:function(){return this._cachedState.textAlign},set:function(n){this._cachedState.textAlign=n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"TextBaseline",{get:function(){return this._cachedState.textBaseline},set:function(n){this._cachedState.textBaseline=n},enumerable:!0,configurable:!0}),n.prototype.SetContextState=function(n){for(var t in this._cachedState)n[t]=this._cachedState[t]},n}();n.Graphic2dState=t})(n._||(n._={}));var t=n._})(n.Assets||(n.Assets={}));var t=n.Assets})(n.Graphics||(n.Graphics={}));var t=n.Graphics}(EndGate||(EndGate={})),function(n){(function(t){var i=function(){function i(i){this._type="Graphic2d",this.Position=i,this.Rotation=0,this.ZIndex=0,this.Visible=!0,this._State=new t.Assets._.Graphic2dState,this.Opacity=1,this._children=[],this._childrenRemovalBindings=[],this.Parent=null,this._disposed=!1,this._onDisposed=new n.EventHandler1}return Object.defineProperty(i.prototype,"AbsolutePosition",{get:function(){for(var n=this.Position,t=this;t=t.Parent;)n=n.Add(t.Position);return n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"OnDisposed",{get:function(){return this._onDisposed},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"Opacity",{get:function(){return this._State.GlobalAlpha},set:function(n){this._State.GlobalAlpha=n},enumerable:!0,configurable:!0}),i.prototype.GetChildren=function(){return this._children.slice(0)},i.prototype.AddChild=function(n){var r=this,t;if(n.Parent!==null)throw new Error("Graphic already has parent, cannot add it as a child.");t=function(n){r.RemoveChild(n)},n.Parent=this,n.OnDisposed.Bind(t),this._children.push(n),this._childrenRemovalBindings.push(t),this._children.sort(i._zindexSort)},i.prototype.RemoveChild=function(n){var t=this._children.indexOf(n);return t>=0?(this._children[t].Parent=null,this._children[t].OnDisposed.Unbind(this._childrenRemovalBindings[t]),this._children.splice(t,1),this._childrenRemovalBindings.splice(t,1),!0):!1},i.prototype._StartDraw=function(n){n.save(),this._State.SetContextState(n),n.translate(this.Position.X,this.Position.Y),this.Rotation!==0&&n.rotate(this.Rotation)},i.prototype._EndDraw=function(n){for(var t=0;t<this._children.length;t++)this._children[t].Visible&&this._children[t].Draw(n);n.restore()},i.prototype.Draw=function(){throw new Error("The Draw method is abstract on Graphic2d and should not be called.");},i.prototype.GetDrawBounds=function(){throw new Error("GetDrawBounds is abstract, it must be implemented.");},i.prototype.Scale=function(){throw new Error("Scale is abstract, it must be implemented.");},i.prototype.Clone=function(){throw new Error("Clone is abstract, it must be implemented.");},i.prototype._Clone=function(n){for(var t=0;t<this._children.length;t++)n.AddChild(this._children[t].Clone());n.Opacity=this.Opacity,n.Rotation=this.Rotation,n.Visible=this.Visible,n.ZIndex=this.ZIndex},i.prototype.Dispose=function(){var t,n;if(this._disposed)throw new Error("Cannot dispose graphic more than once.");else{for(this._disposed=!0,t=this._children.slice(0),n=0;n<t.length;n++)t[n].Dispose();this._children=null,this.OnDisposed.Trigger(this),this.OnDisposed.Dispose()}},i._zindexSort=function(n,t){return n.ZIndex-t.ZIndex},i}();t.Graphic2d=i})(n.Graphics||(n.Graphics={}));var t=n.Graphics}(EndGate||(EndGate={})),function(n){(function(t){var i=function(n){function t(i,r){n.call(this,i,r),this._type="Camera2d",this.Distance=t.DefaultDistance}return __extends(t,n),t.prototype.ToCameraRelative=function(n){var t=this.Position.Subtract(this.Size.Multiply(this._GetDistanceScale()*.5));return t.Add(n.Multiply(this._GetDistanceScale()))},t.prototype._GetInverseDistanceScale=function(){return t.DefaultDistance/this.Distance},t.prototype._GetDistanceScale=function(){return this.Distance/t.DefaultDistance},t.DefaultDistance=1e3,t}(n.Bounds.BoundingRectangle);t.Camera2d=i})(n.Rendering||(n.Rendering={}));var t=n.Rendering}(EndGate||(EndGate={})),function(n){(function(t){var i=function(){function t(t){this._visibleCanvas=t,this._visibleContext=t.getContext("2d"),this._BufferCanvas=document.createElement("canvas"),this._BufferContext=this._BufferCanvas.getContext("2d"),this._onRendererSizeChange=new n.EventHandler1,this.UpdateBufferSize(),this._disposed=!1}return Object.defineProperty(t.prototype,"OnRendererSizeChange",{get:function(){return this._onRendererSizeChange},enumerable:!0,configurable:!0}),t.prototype.Render=function(n){(this._BufferCanvas.width!==this._visibleCanvas.width||this._BufferCanvas.height!==this._visibleCanvas.height)&&this.UpdateBufferSize(),this._visibleContext.clearRect(0,0,this._visibleCanvas.width,this._visibleCanvas.height),this._visibleContext.drawImage(this._BufferCanvas,0,0),this._ClearBuffer(),n.sort(t._zindexSort);for(var i=0;i<n.length;i++)n[i].Draw(this._BufferContext);return this._BufferContext},t.prototype.Dispose=function(){this._disposed||(this._disposed=!0,this._visibleCanvas.parentNode.removeChild(this._visibleCanvas),this._onRendererSizeChange.Dispose())},t.prototype._ClearBuffer=function(){this._BufferContext.clearRect(0,0,this._BufferCanvas.width,this._BufferCanvas.height)},t.prototype.UpdateBufferSize=function(){this._BufferCanvas.width=this._visibleCanvas.width,this._BufferCanvas.height=this._visibleCanvas.height,this.OnRendererSizeChange.Trigger(new n.Size2d(this._visibleCanvas.width,this._visibleCanvas.height))},t._zindexSort=function(n,t){return n.ZIndex-t.ZIndex},t}();t.Renderer2d=i})(n.Rendering||(n.Rendering={}));var t=n.Rendering}(EndGate||(EndGate={})),function(n){(function(n){(function(n){var t=function(){function n(n){this._camera=n,this._canvasCenter=this._camera.Position.Clone(),this._translated=!1,this._translationState=[],this._translationState.push(this._translated)}return n.prototype.Build=function(n){var t=this,i=n.createRadialGradient,r=n.translate,u=n.save,f=n.restore,e=this.BuildPositionReplacer(n.drawImage,1),o=this.BuildPositionReplacer(n.drawImage,5);return n.unModifiedClearRect=n.clearRect,n.arc=this.BuildPositionReplacer(n.arc),n.arcTo=this.BuildPositionReplacer(n.arcTo,0,4),n.bezierCurveTo=this.BuildPositionReplacer(n.bezierCurveTo,0,6),n.clearRect=this.BuildPositionReplacer(n.clearRect),n.createLinearGradient=this.BuildPositionReplacer(n.createLinearGradient,0,4),n.createRadialGradient=function(){var n=t._camera._GetDistanceScale();return arguments[0]+=-t._camera.Position.X+t._canvasCenter.X*n,arguments[1]+=-t._camera.Position.Y+t._canvasCenter.Y*n,arguments[3]+=-t._camera.Position.X+t._canvasCenter.X*n,arguments[4]+=-t._camera.Position.Y+t._canvasCenter.Y*n,i.apply(this,arguments)},n.drawImage=function(){arguments.length<=5?e.apply(this,arguments):o.apply(this,arguments)},n.fillRect=this.BuildPositionReplacer(n.fillRect),n.fillText=this.BuildPositionReplacer(n.fillText,1),n.getImageData=this.BuildPositionReplacer(n.getImageData),n.isPointInPath=this.BuildPositionReplacer(n.isPointInPath),n.lineTo=this.BuildPositionReplacer(n.lineTo),n.moveTo=this.BuildPositionReplacer(n.moveTo),n.putImageData=this.BuildPositionReplacer(n.putImageData,1),n.quadraticCurveTo=this.BuildPositionReplacer(n.quadraticCurveTo,0,4),n.rect=this.BuildPositionReplacer(n.rect),n.strokeRect=this.BuildPositionReplacer(n.strokeRect),n.strokeText=this.BuildPositionReplacer(n.strokeText,1),n.save=function(){t._translationState.push(t._translated),u.call(this)},n.restore=function(){t._translated=t._translationState.pop(),f.call(this)},n.translate=function(){var n;t._translated||(n=t._camera._GetDistanceScale(),arguments[0]+=-t._camera.Position.X+t._canvasCenter.X*n,arguments[1]+=-t._camera.Position.Y+t._canvasCenter.Y*n),t._translated=!0,r.apply(this,arguments)},n},n.prototype._UpdateCanvasCenter=function(n){this._canvasCenter.X=n.Width/2,this._canvasCenter.Y=n.Height/2},n.prototype.BuildPositionReplacer=function(n,t,i){typeof t=="undefined"&&(t=0),typeof i=="undefined"&&(i=2);var r=this,u=["X","Y"];return function(){var o,e,f;if(!r._translated)for(o=r._camera._GetDistanceScale(),f=0;f<i;f++)e=u[f%2],arguments[t+f]+=-r._camera.Position[e]+r._canvasCenter[e]*o;return n.apply(this,arguments)}},n}();n.Camera2dCanvasContextBuilder=t})(n._||(n._={}));var t=n._})(n.Rendering||(n.Rendering={}));var t=n.Rendering}(EndGate||(EndGate={})),function(n){(function(t){var i=function(i){function r(r,u){i.call(this,r),this._camera=u,this._contextBuilder=new t._.Camera2dCanvasContextBuilder(this._camera),this.OnRendererSizeChange.Bind(this._contextBuilder._UpdateCanvasCenter),this._contextBuilder._UpdateCanvasCenter(new n.Size2d(r.width,r.height)),this._BufferContext=this._contextBuilder.Build(this._BufferContext)}return __extends(r,i),r.prototype.Render=function(n){var t,r=this._camera._GetInverseDistanceScale();return this._BufferContext.save(),this._BufferContext.scale(r,r),t=i.prototype.Render.call(this,this.GetOnScreenRenderables(n)),this._BufferContext.restore(),t},r.prototype._ClearBuffer=function(){var n=this._camera._GetDistanceScale();this._BufferContext.unModifiedClearRect(0,0,this._BufferCanvas.width*n,this._BufferCanvas.height*n)},r.prototype.GetOnScreenRenderables=function(n){var r=[],i=this._camera._GetDistanceScale(),u=1/i,t;for(this._camera.Scale(i,i),t=0;t<n.length;t++)n[t].Visible&&this._camera.Intersects(n[t].GetDrawBounds())&&r.push(n[t]);return this._camera.Scale(u,u),r},r}(t.Renderer2d);t.Camera2dRenderer=i})(n.Rendering||(n.Rendering={}));var t=n.Rendering}(EndGate||(EndGate={})),function(n){(function(t){var i=function(){function i(i,r){typeof i=="undefined"&&(i=function(){}),this._actorMappings=[],this._actors=[],typeof r=="undefined"&&(r=this.CreateDefaultDrawArea()),this._onDraw=i,this._drawArea=r,this._camera=new t.Camera2d(new n.Vector2d(this._drawArea.width/2,this._drawArea.height/2),new n.Size2d(this._drawArea.width,this._drawArea.height)),this._renderer=new t.Camera2dRenderer(this._drawArea,this._camera),this._disposed=!1}return Object.defineProperty(i.prototype,"DrawArea",{get:function(){return this._drawArea},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"Camera",{get:function(){return this._camera},enumerable:!0,configurable:!0}),i.prototype.Add=function(n){var i=this,t={Actor:n,Remove:function(n){i.Remove(n)}};n.OnDisposed.Bind(t.Remove),this._actorMappings.push(t),this._actors.push(n)},i.prototype.Remove=function(n){for(var t=0;t<this._actors.length;t++)if(this._actors[t]===n){this._actors[t].OnDisposed.Unbind(this._actorMappings[t].Remove),this._actors.splice(t,1),this._actorMappings.splice(t,1);return}},i.prototype.Draw=function(){this._onDraw(this._renderer.Render(this._actors))},i.prototype.Dispose=function(){if(this._disposed)throw new Error("Scene2d cannot be disposed more than once");else{this._disposed=!0;for(var n=0;n<this._actors.length;n++)this.Remove(this._actors[n]);this._actors=[],this._actorMappings=[],this._renderer.Dispose()}},i.prototype.CreateDefaultDrawArea=function(){var n=document.createElement("canvas"),t=document.getElementsByTagName("body")[0];return n.width=document.documentElement.clientWidth,n.height=document.documentElement.clientHeight-5,t.appendChild(n),t.style.margin="0px",t.style.padding="0px",n},i}();t.Scene2d=i})(n.Rendering||(n.Rendering={}));var t=n.Rendering}(EndGate||(EndGate={})),function(n){(function(n){(function(n){var t=function(){function n(){}return n.Left="Left",n.Middle="Middle",n.Right="Right",n}();n.MouseButton=t})(n._||(n._={}));var t=n._})(n.Input||(n.Input={}));var t=n.Input}(EndGate||(EndGate={})),function(n){(function(t){var i=function(){function i(t){var i=this;this._target=t,this._disposed=!1,this._onClick=new n.EventHandler1,this._onDoubleClick=new n.EventHandler1,this._onDown=new n.EventHandler1,this._onUp=new n.EventHandler1,this._onMove=new n.EventHandler1,this._onScroll=new n.EventHandler1,this._leftIsDown=!1,this._middleIsDown=!1,this._rightIsDown=!1,this.Wire(),this.OnDown.Bind(function(n){i._isDown=!0,i[n.Button+"IsDown"]=!0}),this.OnUp.Bind(function(n){i._isDown=!1,i[n.Button+"IsDown"]=!1})}return Object.defineProperty(i.prototype,"LeftIsDown",{get:function(){return this._leftIsDown},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"MiddleIsDown",{get:function(){return this._middleIsDown},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"RightIsDown",{get:function(){return this._rightIsDown},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"IsDown",{get:function(){return this._isDown},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"OnClick",{get:function(){return this._onClick},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"OnDoubleClick",{get:function(){return this._onDoubleClick},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"OnDown",{get:function(){return this._onDown},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"OnUp",{get:function(){return this._onUp},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"OnMove",{get:function(){return this._onMove},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"OnScroll",{get:function(){return this._onScroll},enumerable:!0,configurable:!0}),i.prototype.Dispose=function(){if(this._disposed)throw new Error("MouseHandler cannot be disposed more than once");else this._disposed=!0,this._onClick.Dispose(),this._onDoubleClick.Dispose(),this._onDown.Dispose(),this._onMove.Dispose(),this._onScroll.Dispose(),this._onUp.Dispose(),this.Unwire(),this._target=null},i.prototype.Wire=function(){var n=this;this._clickWire=this._contextMenuWire=this.BuildEvent(this._onClick,this.BuildMouseClickEvent),this._dblClickWire=this.BuildEvent(this._onDoubleClick,this.BuildMouseClickEvent),this._mouseDownWire=this.BuildEvent(this._onDown,this.BuildMouseClickEvent),this._mouseUpWire=this.BuildEvent(this._onUp,this.BuildMouseClickEvent),this._mouseMoveWire=this.BuildEvent(this._onMove,this.BuildMouseEvent),/MSIE/i.test(navigator.userAgent)?(this._mouseWheelWireName="wheel",this._mouseWheelWire=this.BuildEvent(this._onScroll,function(t){return t.wheelDeltaX=-t.deltaX,t.wheelDeltaY=-t.deltaY,n.BuildMouseScrollEvent(t)})):/Firefox/i.test(navigator.userAgent)?(this._mouseWheelWireName="DOMMouseScroll",this._mouseWheelWire=this.BuildEvent(this._onScroll,function(t){return t.wheelDeltaX=t.axis===1?-t.detail:0,t.wheelDeltaY=t.axis===2?-t.detail:0,n.BuildMouseScrollEvent(t)})):(this._mouseWheelWireName="mousewheel",this._mouseWheelWire=this.BuildEvent(this._onScroll,this.BuildMouseScrollEvent)),this._target.addEventListener("click",this._clickWire,!1),this._target.addEventListener("contextmenu",this._contextMenuWire,!1),this._target.addEventListener("dblclick",this._dblClickWire,!1),this._target.addEventListener("mousedown",this._mouseDownWire,!1),this._target.addEventListener("mouseup",this._mouseUpWire,!1),this._target.addEventListener("mousemove",this._mouseMoveWire,!1),this._target.addEventListener(this._mouseWheelWireName,this._mouseWheelWire,!1)},i.prototype.Unwire=function(){this._target.removeEventListener("click",this._clickWire,!1),this._target.removeEventListener("contextmenu",this._contextMenuWire,!1),this._target.removeEventListener("dblclick",this._dblClickWire,!1),this._target.removeEventListener("mousedown",this._mouseDownWire,!1),this._target.removeEventListener("mouseup",this._mouseUpWire,!1),this._target.removeEventListener("mousemove",this._mouseMoveWire,!1),this._target.removeEventListener(this._mouseWheelWireName,this._mouseWheelWire,!1)},i.prototype.BuildEvent=function(n,t,i){typeof i=="undefined"&&(i=!1);var r=this;return function(u){return n.HasBindings()&&n.Trigger(t.call(r,u)),u.preventDefault(),i}},i.prototype.BuildMouseScrollEvent=function(n){return{Position:this.GetMousePosition(n),Direction:this.GetMouseScrollDierction(n)}},i.prototype.BuildMouseEvent=function(n){return{Position:this.GetMousePosition(n)}},i.prototype.BuildMouseClickEvent=function(n){return{Position:this.GetMousePosition(n),Button:this.GetMouseButton(n)}},i.prototype.GetMousePosition=function(t){return new n.Vector2d(t.offsetX?t.offsetX:t.pageX-this._target.offsetLeft,t.offsetY?t.offsetY:t.pageY-this._target.offsetTop)},i.prototype.GetMouseButton=function(n){return n.which?i.MouseButtonArray[n.which]:t._.MouseButton.Right},i.prototype.GetMouseScrollDierction=function(t){return new n.Vector2d(-Math.max(-1,Math.min(1,t.wheelDeltaX)),-Math.max(-1,Math.min(1,t.wheelDeltaY)))},i.MouseButtonArray=[null,t._.MouseButton.Left,t._.MouseButton.Middle,t._.MouseButton.Right],i}();t.MouseHandler=i})(n.Input||(n.Input={}));var t=n.Input}(EndGate||(EndGate={})),function(n){(function(n){(function(n){var t=function(){function n(t,i){typeof i=="undefined"&&(i=!1),this._invoker=n._noop,this._action=t,i&&this.Trip()}return n.prototype.Invoke=function(){for(var t=[],n=0;n<arguments.length-0;n++)t[n]=arguments[n+0];this._invoker.apply(this,t)},n.prototype.InvokeOnce=function(){for(var t=[],n=0;n<arguments.length-0;n++)t[n]=arguments[n+0];this._invoker.apply(this,t),this.Reset()},n.prototype.Trip=function(){this._invoker=this._action},n.prototype.Reset=function(){this._invoker=n._noop},n._noop=function(){},n}();n.NoopTripInvoker=t})(n.Utilities||(n.Utilities={}));var t=n.Utilities})(n._||(n._={}));var t=n._}(EndGate||(EndGate={})),function(n){(function(n){(function(n){var t=function(){function n(n,t,i){this.Ctrl=n,this.Alt=t,this.Shift=i}return n.prototype.Equivalent=function(n){return this.Ctrl===n.Ctrl&&this.Alt===n.Alt&&this.Shift===n.Shift},n.BuildFromCommandString=function(t){var i=t.toLowerCase().indexOf("ctrl+")>=0?!0:!1,r=t.toLowerCase().indexOf("alt+")>=0?!0:!1,u=t.toLowerCase().indexOf("shift+")>=0?!0:!1;return new n(i,r,u)},n}();n.KeyboardModifiers=t})(n.Assets||(n.Assets={}));var t=n.Assets})(n.Input||(n.Input={}));var t=n.Input}(EndGate||(EndGate={})),function(n){(function(n){var t={"~":"`","!":"1","@":"2","#":"3",$:"4","%":"5","^":"6","&":"7","*":"8","(":"9",")":"0",_:"-","+":"=",":":";",'"':"'","<":",",">":".","?":"/","|":"\\"},i={"27":"esc","27":"escape","9":"tab","32":"space","13":"return","13":"enter","8":"backspace","45":"insert","36":"home","46":"delete","35":"end","37":"left","38":"up","39":"right","40":"down","112":"f1","113":"f2","114":"f3","115":"f4","116":"f5","117":"f6","118":"f7","119":"f8","120":"f9","121":"f10","122":"f11","123":"f12"},r=function(){function r(r){var f,u;this.Modifiers=new n.Assets.KeyboardModifiers(r.ctrlKey,r.altKey,r.shiftKey),r.keyCode?f=r.keyCode:r.which&&(f=r.which),(u=String.fromCharCode(r.keyCode))===r.key||(u=i[f])||(u=String.fromCharCode(f).toLowerCase(),this.Modifiers.Shift&&t[u]&&(u=t[u])),this.Key=u}return r.prototype.Matches=function(n){return this.Key.toLowerCase()===n.Key.toLowerCase()&&n.Modifiers.Equivalent(this.Modifiers)},r}();n.KeyboardCommandEvent=r})(n.Input||(n.Input={}));var t=n.Input}(EndGate||(EndGate={})),function(n){(function(n){(function(n){var t=function(){function n(){}return n.ParseKey=function(n){var t=n.split("+");return t.length>1?t[t.length-1]:t[0]},n}();n.KeyboardCommandHelper=t})(n._||(n._={}));var t=n._})(n.Input||(n.Input={}));var t=n.Input}(EndGate||(EndGate={})),function(n){(function(t){(function(i){var r=function(){function i(i,r){var u=this;this.Action=r,this.Modifiers=t.Assets.KeyboardModifiers.BuildFromCommandString(i),this.Key=t._.KeyboardCommandHelper.ParseKey(i),this._onDisposed=new n.EventHandler,this._onDisposeInvoker=new n._.Utilities.NoopTripInvoker(function(){u._onDisposed.Trigger()},!0)}return Object.defineProperty(i.prototype,"OnDispose",{get:function(){return this._onDisposed},enumerable:!0,configurable:!0}),i.prototype.Dispose=function(){this._onDisposeInvoker.InvokeOnce()},i}();i.KeyboardCommand=r})(t.Assets||(t.Assets={}));var i=t.Assets})(n.Input||(n.Input={}));var t=n.Input}(EndGate||(EndGate={})),function(n){(function(t){var i=function(){function i(){this._onPressCommands={},this._onDownCommands={},this._onUpCommands={},this._onKeyPress=new n.EventHandler1,this._onKeyDown=new n.EventHandler1,this._onKeyUp=new n.EventHandler1,this._disposed=!1,this.Wire()}return Object.defineProperty(i.prototype,"OnKeyPress",{get:function(){return this._onKeyPress},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"OnKeyDown",{get:function(){return this._onKeyDown},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"OnKeyUp",{get:function(){return this._onKeyUp},enumerable:!0,configurable:!0}),i.prototype.OnCommandPress=function(n,t){return this.UpdateCache(n,t,this._onPressCommands)},i.prototype.OnCommandDown=function(n,t){return this.UpdateCache(n,t,this._onDownCommands)},i.prototype.OnCommandUp=function(n,t){return this.UpdateCache(n,t,this._onUpCommands)},i.prototype.Dispose=function(){var n;if(this._disposed)throw new Error("KeyboardHandler cannot be disposed more than once");else{this._disposed=!0,this._onKeyDown.Dispose(),this._onKeyPress.Dispose(),this._onKeyUp.Dispose();for(n in this._onDownCommands)this._onDownCommands[n].Dispose();this._onDownCommands=null;for(n in this._onUpCommands)this._onUpCommands[n].Dispose();this._onUpCommands=null;for(n in this._onPressCommands)this._onPressCommands[n].Dispose();this._onPressCommands=null,this.Unwire()}},i.prototype.UpdateCache=function(n,r,u){var f=new t.Assets.KeyboardCommand(n,r),e=i._keyboardCommandIds++;return f.OnDispose.Bind(function(){delete u[e]}),u[e]=f,f},i.prototype.Wire=function(){this._keyPressWire=this.BuildKeyEvent(this._onPressCommands,this.OnKeyPress),this._keyDownWire=this.BuildKeyEvent(this._onDownCommands,this.OnKeyDown),this._keyUpWire=this.BuildKeyEvent(this._onUpCommands,this.OnKeyUp),document.addEventListener("keypress",this._keyPressWire,!1),document.addEventListener("keydown",this._keyDownWire,!1),document.addEventListener("keyup",this._keyUpWire,!1)},i.prototype.Unwire=function(){document.removeEventListener("keypress",this._keyPressWire,!1),document.removeEventListener("keydown",this._keyDownWire,!1),document.removeEventListener("keyup",this._keyUpWire,!1)},i.prototype.FocusingTextArea=function(n){var t;return(n.target?t=n.target:n.srcElement&&(t=n.srcElement),t.nodeType===3&&(t=t.parentNode),t.tagName==="INPUT"||t.tagName==="TEXTAREA")?!0:!1},i.prototype.BuildKeyEvent=function(n,i){var r=this;return function(u){var f,o=!0,e;if(!r.FocusingTextArea(u)){f=new t.KeyboardCommandEvent(u),i.Trigger(f);for(e in n)f.Matches(n[e])&&(n[e].Action(),u.preventDefault(),o=!1);return o}}},i._keyboardCommandIds=0,i}();t.KeyboardHandler=i})(n.Input||(n.Input={}));var t=n.Input}(EndGate||(EndGate={})),function(n){(function(n){var t=function(){function t(t){this._disposed=!1,this.Mouse=new n.MouseHandler(t),this.Keyboard=new n.KeyboardHandler}return t.prototype.Dispose=function(){if(this._disposed)throw new Error("MouseHandler cannot be disposed more than once");else this._disposed=!0,this.Mouse.Dispose(),this.Keyboard.Dispose()},t}();n.InputManager=t})(n.Input||(n.Input={}));var t=n.Input}(EndGate||(EndGate={})),function(n){(function(t){var i=function(){function t(t,i,r,u,f,e,o){typeof u=="undefined"&&(u=0),typeof f=="undefined"&&(f=0),typeof e=="undefined"&&(e=i),typeof o=="undefined"&&(o=r);var s=this,c=typeof i!="undefined",h;this._onLoaded=new n.EventHandler1,typeof t=="string"?(h=t,this._loaded=!1,this.Source=new Image,this.Source.onload=function(){s._loaded=!0,c||(s._size=new n.Size2d(s.Source.width,s.Source.height),s.ClipLocation=n.Vector2d.Zero,s.ClipSize=s._size.Clone()),s._onLoaded.Trigger(s)},this.Source.src=h,this._imageLocation=h,c?(this._size=new n.Size2d(i,r),this.ClipLocation=new n.Vector2d(u,f),this.ClipSize=new n.Size2d(e,o)):this.ClipSize=null):(this._loaded=!0,this.Source=t,this._imageLocation=t.src,this._size=new n.Size2d(t.width,t.height),this.ClipLocation=new n.Vector2d(u,f),this.ClipSize=new n.Size2d(e,o))}return Object.defineProperty(t.prototype,"OnLoaded",{get:function(){return this._onLoaded},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Size",{get:function(){return this._size.Clone()},enumerable:!0,configurable:!0}),t.prototype.IsLoaded=function(){return this._loaded},t.prototype.Extract=function(n,i,r,u){return new t(this._imageLocation,this._size.Width,this._size.Height,n,i,r,u)},t.prototype.Dispose=function(){this.Source=null,this._onLoaded.Dispose()},t.prototype.Clone=function(){return new t(this.Source,this.Size.Width,this.Size.Height,this.ClipLocation.X,this.ClipLocation.Y,this.ClipSize.Width,this.ClipSize.Height)},t}();t.ImageSource=i})(n.Graphics||(n.Graphics={}));var t=n.Graphics}(EndGate||(EndGate={})),function(n){(function(n){var t=function(){function n(n,t,i,r){typeof n=="undefined"&&(n=!1),typeof t=="undefined"&&(t=100),typeof i=="undefined"&&(i=!1),typeof r=="undefined"&&(r="auto"),this.Repeat=n,this.Volume=t,this.AutoPlay=i,this.Preload=r}return n.prototype.Clone=function(){return new n(this.Repeat,this.Volume,this.AutoPlay,this.Preload)},n.Default=new n,n}();n.AudioSettings=t})(n.Sound||(n.Sound={}));var t=n.Sound}(EndGate||(EndGate={})),function(n){(function(t){var i={mp3:"audio/mpeg",ogg:"audio/ogg",wav:"audio/wav",aac:"audio/aac",m4a:"audio/x-m4a"},r=function(){function r(i,r){typeof r=="undefined"&&(r=t.AudioSettings.Default),this._disposed=!1,this._settings=r.Clone(),this._canPlayWires=[],i instanceof HTMLAudioElement?this._audio=i:(this._audio=document.createElement("audio"),this.SetAudioSource(i)),this.ApplySettings(),this._onComplete=new n.EventHandler1}return Object.defineProperty(r.prototype,"OnComplete",{get:function(){return this._onComplete},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"Volume",{get:function(){return this._settings.Volume},set:function(n){this._settings.Volume=n,this._audio.volume=Math.max(Math.min(n/100,1),0)},enumerable:!0,configurable:!0}),r.prototype.IsPlaying=function(){return!this._audio.paused},r.prototype.IsComplete=function(){return this._audio.ended},r.prototype.Play=function(){var t=this,n;this._audio.readyState===0?(n=function(){t._audio.play()},this._canPlayWires.push(n),this._audio.addEventListener("canplay",n,!0)):this._audio.play()},r.prototype.Pause=function(){this._audio.pause()},r.prototype.Seek=function(n){var i=this,t;this._audio.readyState===0?(t=function(){i._audio.currentTime=n},this._canPlayWires.push(t),this._audio.addEventListener("canplay",t,!0)):this._audio.currentTime=n},r.prototype.Stop=function(){this.Seek(0),this._audio.pause()},r.prototype.Dispose=function(){if(this._disposed)throw new Error("Cannot dispose AudioClip more than once.");else{this._disposed=!0,this._onComplete.Dispose();for(var n=0;n<this._canPlayWires.length;n++)this._audio.removeEventListener("canplay",this._canPlayWires[n],!0);this._audio.removeEventListener("ended",this._endedWire,!0),this._audio=null,this._settings=null}},r.prototype.SetAudioSource=function(n){var r,u,t;for(n instanceof Array||(n=[n]),t=0;t<n.length;t++)r=document.createElement("source"),r.src=n[t],u=i[n[t].split(".").pop()],typeof u!="undefined"&&(r.type=u),this._audio.appendChild(r)},r.prototype.ApplySettings=function(){var n=this;this._audio.loop=this._settings.Repeat,this._audio.autoplay=this._settings.AutoPlay,this._audio.preload=this._settings.Preload,this.Volume=this._settings.Volume,this._endedWire=function(t){n.OnComplete.Trigger(t)},this._audio.addEventListener("ended",this._endedWire,!0)},r}();t.AudioClip=r})(n.Sound||(n.Sound={}));var t=n.Sound}(EndGate||(EndGate={})),function(n){(function(n){var t=function(){function t(n){n instanceof Array?this._source=n:(this._source=[],this._source.push(n))}return t.prototype.BuildClip=function(t){return typeof t=="undefined"&&(t=n.AudioSettings.Default),new n.AudioClip(this._source,t)},t.prototype.Play=function(t){typeof t=="undefined"&&(t=n.AudioSettings.Default);var i=new n.AudioClip(this._source,t);return i.Play(),i},t}();n.AudioPlayer=t})(n.Sound||(n.Sound={}));var t=n.Sound}(EndGate||(EndGate={})),function(n){(function(t){var i=function(){function t(){this._images={},this._audioPlayers={}}return t.prototype.LoadImage=function(t,i,r,u){var f=new n.Graphics.ImageSource(i,r,u);return this._images[t]=f,f.Clone()},t.prototype.GetImage=function(n){if(this._images[n])return this._images[n].Clone();throw new Error("Image with name '"+n+"' was not found.");},t.prototype.UnloadImage=function(n){return this._images[n]?(delete this._images[n],!0):!1},t.prototype.LoadAudio=function(t,i){return this._audioPlayers[t]=new n.Sound.AudioPlayer(i),this._audioPlayers[t]},t.prototype.GetAudio=function(n){if(this._audioPlayers[n])return this._audioPlayers[n];throw new Error("Audio with name '"+n+"' was not found.");},t.prototype.UnloadAudio=function(n){var t=this._audioPlayers[n];return delete this._audioPlayers[n],t},t}();t.ContentManager=i})(n.Content||(n.Content={}));var t=n.Content}(EndGate||(EndGate={})),function(n){var t=function(){function t(i){var u=this,r,f;this._type="Game",f=n.Collision.CollisionConfiguration._DefaultMinQuadTreeNodeSize,this._updateRequired=!0,this._gameTime=new n.GameTime,this._ID=t._gameIds++,this.Scene=new n.Rendering.Scene2d(function(n){u.Draw(n)},i),this.Input=new n.Input.InputManager(this.Scene.DrawArea),this.Content=new n.Content.ContentManager,r=this.Scene.Camera.Size,r.Width%f.Width!=0&&(r=new n.Size2d(r.Width%f.Width+r.Width)),this.Configuration=new n.GameConfiguration(GameRunnerInstance.Register(this),r),this.CollisionManager=new n.Collision.CollisionManager(this.Configuration.CollisionConfiguration),this.Configuration.CollisionConfiguration._OnChange.Bind(function(){u.CollisionManager=new n.Collision.CollisionManager(u.Configuration.CollisionConfiguration)}),this._PrepareLoadContent()}return t.prototype._PrepareUpdate=function(){this._gameTime.Update(),this.Update(this._gameTime),this.CollisionManager.Update(this._gameTime),this._updateRequired=!1},t.prototype._PrepareLoadContent=function(){this.LoadContent()},t.prototype.LoadContent=function(){},t.prototype.Update=function(){},t.prototype._PrepareDraw=function(){this.Configuration.DrawOnlyAfterUpdate&&this._updateRequired||(this.Scene.Draw(),this._updateRequired=!0)},t.prototype.Draw=function(){},t.prototype.Dispose=function(){this.Scene.Dispose(),this.CollisionManager.Dispose(),this.Input.Dispose(),GameRunnerInstance.Unregister(this)},t._gameIds=0,t}();n.Game=t}(EndGate||(EndGate={})),function(n){(function(n){(function(n){var t=function(){function n(){this.Left=!1,this.Right=!1,this.Up=!1,this.Down=!1}return n}();n.LinearDirections=t})(n.Assets||(n.Assets={}));var t=n.Assets})(n.MovementControllers||(n.MovementControllers={}));var t=n.MovementControllers}(EndGate||(EndGate={})),function(n){(function(t){var i=function(){function t(t){this.Position=t.length>0?t[0].Position:n.Vector2d.Zero,this.Velocity=n.Vector2d.Zero,this.Rotation=0,this._frozen=!1,this._moveables=t}return t.prototype.Freeze=function(){this._frozen=!0},t.prototype.Thaw=function(){this._frozen=!1},t.prototype.IsMoving=function(){return!this._frozen&&!this.Velocity.IsZero()},t.prototype.Update=function(){for(var n=0;n<this._moveables.length;n++)this._moveables[n].Position=this.Position,this._moveables[n].Rotation=this.Rotation},t}();t.MovementController=i})(n.MovementControllers||(n.MovementControllers={}));var t=n.MovementControllers}(EndGate||(EndGate={})),function(n){(function(t){var i=function(i){function r(r,u,f,e){typeof f=="undefined"&&(f=!0),typeof e=="undefined"&&(e=!0);var o=this;i.call(this,r),this._moveSpeed=u,this._moving=new t.Assets.LinearDirections,this.OnMove=new n.EventHandler1,this._rotationUpdater=new n._.Utilities.NoopTripInvoker(function(){o.UpdateRotation()},f),this._velocityUpdater=e?this.UpdateVelocityWithMultiDirection:this.UpdateVelocityNoMultiDirection}return __extends(r,i),r.prototype.IsMovingInDirection=function(n){return this._moving[n]||!1},r.prototype.StartMoving=function(n){this.Move(n,!0)},r.prototype.StopMoving=function(n){this.Move(n,!1)},r.prototype.MoveSpeed=function(n){return typeof n!="undefined"&&(this._moveSpeed=n,this._velocityUpdater()),this._moveSpeed},r.prototype.Update=function(n){this._frozen||(this.Position=this.Position.Add(this.Velocity.Multiply(n.Elapsed.Seconds)),i.prototype.Update.call(this,n))},r.prototype.Move=function(n,t){if(typeof this._moving[n]!="undefined")this._moving[n]=t,this._velocityUpdater(),this._rotationUpdater.Invoke(),this.OnMove.Trigger({Direction:n,StartMoving:t});else throw new Error(n+" is an unknown direction.");},r.prototype.UpdateVelocityNoMultiDirection=function(){var t=n.Vector2d.Zero;t.IsZero()&&(this._moving.Up&&(t.Y-=this._moveSpeed),this._moving.Down&&(t.Y+=this._moveSpeed),t.Y===0&&(this._moving.Left&&(t.X-=this._moveSpeed),this._moving.Right&&(t.X+=this._moveSpeed))),this.Velocity=t},r.prototype.UpdateVelocityWithMultiDirection=function(){var t=n.Vector2d.Zero;this._moving.Up&&(t.Y-=this._moveSpeed),this._moving.Down&&(t.Y+=this._moveSpeed),this._moving.Left&&(t.X-=this._moveSpeed),this._moving.Right&&(t.X+=this._moveSpeed),this.Velocity=t},r.prototype.UpdateRotation=function(){this.Velocity.IsZero()||(this.Rotation=Math.atan2(this.Velocity.Y,this.Velocity.X))},r}(t.MovementController);t.LinearMovementController=i})(n.MovementControllers||(n.MovementControllers={}));var t=n.MovementControllers}(EndGate||(EndGate={})),function(n){(function(t){var i=function(){function t(t,i,r,u,f,e){typeof r=="undefined"&&(r=["w","Up"]),typeof u=="undefined"&&(u=["d","Right"]),typeof f=="undefined"&&(f=["s","Down"]),typeof e=="undefined"&&(e=["a","Left"]),this._keyboard=t,this._onMove=i,this._directions=new n.MovementControllers.Assets.LinearDirections,this.BindKeys(r,"OnCommandDown","Up",!0),this.BindKeys(u,"OnCommandDown","Right",!0),this.BindKeys(f,"OnCommandDown","Down",!0),this.BindKeys(e,"OnCommandDown","Left",!0),this.BindKeys(r,"OnCommandUp","Up",!1),this.BindKeys(u,"OnCommandUp","Right",!1),this.BindKeys(f,"OnCommandUp","Down",!1),this.BindKeys(e,"OnCommandUp","Left",!1)}return t.prototype.BindKeys=function(n,t,i,r){for(var f=this,u=0;u<n.length;u++)this._keyboard[t](n[u],function(){f._directions[i]!=r&&(f._directions[i]=r,f._onMove(i,r))})},t}();t.DirectionalInputController=i})(n.InputControllers||(n.InputControllers={}));var t=n.InputControllers}(EndGate||(EndGate={})),function(n){(function(t){var i=function(){function t(t,i,r,u){this._type="Color",this._cached=undefined,this._onChange=new n.EventHandler1,typeof t=="string"&&t.length>0?this.InitializeColorFromString(t):(this.A=u===undefined?1:u,this.R=t,this.G=i,this.B=r)}return Object.defineProperty(t.prototype,"OnChange",{get:function(){return this._onChange},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"R",{get:function(){return this._r},set:function(n){this._cached=undefined,this._r=Math.round(Math.min(Math.max(n,0),255)),this._onChange.Trigger(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"G",{get:function(){return this._g},set:function(n){this._cached=undefined,this._g=Math.round(Math.min(Math.max(n,0),255)),this._onChange.Trigger(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"B",{get:function(){return this._b},set:function(n){this._cached=undefined,this._b=Math.round(Math.min(Math.max(n,0),255)),this._onChange.Trigger(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"A",{get:function(){return this._a},set:function(n){this._cached=undefined,this._a=Math.min(Math.max(n,0),1),this._onChange.Trigger(this)},enumerable:!0,configurable:!0}),t.FromRGB=function(n,i,r){return new t(n,i,r)},t.FromRGBA=function(n,i,r,u){return new t(n,i,r,u)},t.FromARGB=function(n,i,r,u){return new t(i,r,u,n)},t.FromHex=function(n){return new t(n)},t.FromName=function(n){return new t(n)},t.ConvertShortHexToLong=function(n){return n.length===3&&(n=n+"f"),n.length===4&&(n=n.replace(t.RgbaHexRegExp,function(n,t,i,r,u){return i+i+r+r+u+u+t+t})),n},t.prototype.InitializeColorFromString=function(n){var i=this.NamedColorToHex(n),t=null;t=typeof i=="string"?this.CreateColorObjectFromString(i):i,this.A=t.A,this.B=t.B,this.R=t.R,this.G=t.G},t.prototype.CreateColorObjectFromString=function(n){return(n.charAt(0)==="#"&&(n=n.substr(1)),n=t.ConvertShortHexToLong(n),n.length===6&&(n=n+"ff"),n.length===8)?this.ParseAlphaHex(n):this.ParseRGB(n)},t.prototype.ParseRGB=function(n){var i=t.RgbRegExp.exec(n),r;if(i){r=i[1];switch(r){case"rgb":return new t(parseInt(i[2]),parseInt(i[3]),parseInt(i[4]));case"argb":return new t(parseInt(i[3]),parseInt(i[4]),parseInt(i[5]),parseFloat(i[2]));case"rgba":return new t(parseInt(i[2]),parseInt(i[3]),parseInt(i[4]),parseFloat(i[5]))}}return t.Magenta},t.prototype.ParseAlphaHex=function(n){var i,r,u,f;return r=parseInt(n.charAt(0)+n.charAt(1),16),u=parseInt(n.charAt(2)+n.charAt(3),16),f=parseInt(n.charAt(4)+n.charAt(5),16),i=parseInt(n.charAt(6)+n.charAt(7),16)/255,new t(r,u,f,i)},t.prototype.ParseHex=function(n){var i,r,u;return i=parseInt(n.charAt(0)+n.charAt(1),16),r=parseInt(n.charAt(2)+n.charAt(3),16),u=parseInt(n.charAt(4)+n.charAt(5),16),new t(i,r,u)},t.prototype.NamedColorToHex=function(n){return n.substring(0,1)==="#"?n:typeof t._namedColors[n.toLowerCase()]!="undefined"?t._namedColors[n.toLowerCase()]:n},Object.defineProperty(t,"Transparent",{get:function(){return t._namedColors.transparent.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"AliceBlue",{get:function(){return t._namedColors.aliceblue.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"AntiqueWhite",{get:function(){return t._namedColors.antiquewhite.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"Aqua",{get:function(){return t._namedColors.aqua.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"Aquamarine",{get:function(){return t._namedColors.aquamarine.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"Azure",{get:function(){return t._namedColors.azure.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"Beige",{get:function(){return t._namedColors.beige.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"Bisque",{get:function(){return t._namedColors.bisque.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"Black",{get:function(){return t._namedColors.black.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"BlanchedAlmond",{get:function(){return t._namedColors.blanchedalmond.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"Blue",{get:function(){return t._namedColors.blue.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"BlueViolet",{get:function(){return t._namedColors.blueviolet.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"Brown",{get:function(){return t._namedColors.brown.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"BurlyWood",{get:function(){return t._namedColors.burlywood.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"CadetBlue",{get:function(){return t._namedColors.cadetblue.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"Chartreuse",{get:function(){return t._namedColors.chartreuse.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"Chocolate",{get:function(){return t._namedColors.chocolate.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"Coral",{get:function(){return t._namedColors.coral.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"CornflowerBlue",{get:function(){return t._namedColors.cornflowerblue.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"Cornsilk",{get:function(){return t._namedColors.cornsilk.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"Crimson",{get:function(){return t._namedColors.crimson.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"Cyan",{get:function(){return t._namedColors.cyan.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"DarkBlue",{get:function(){return t._namedColors.darkblue.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"DarkCyan",{get:function(){return t._namedColors.darkcyan.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"DarkGoldenRod",{get:function(){return t._namedColors.darkgoldenrod.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"DarkGray",{get:function(){return t._namedColors.darkgray.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"DarkGreen",{get:function(){return t._namedColors.darkgreen.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"DarkKhaki",{get:function(){return t._namedColors.darkkhaki.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"DarkMagenta",{get:function(){return t._namedColors.darkmagenta.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"DarkOliveGreen",{get:function(){return t._namedColors.darkolivegreen.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"DarkOrange",{get:function(){return t._namedColors.darkorange.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"DarkOrchid",{get:function(){return t._namedColors.darkorchid.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"DarkRed",{get:function(){return t._namedColors.darkred.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"DarkSalmon",{get:function(){return t._namedColors.darksalmon.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"DarkSeaGreen",{get:function(){return t._namedColors.darkseagreen.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"DarkSlateBlue",{get:function(){return t._namedColors.darkslateblue.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"DarkSlateGray",{get:function(){return t._namedColors.darkslategray.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"DarkTurquoise",{get:function(){return t._namedColors.darkturquoise.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"DarkViolet",{get:function(){return t._namedColors.darkviolet.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"DeepPink",{get:function(){return t._namedColors.deeppink.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"DeepSkyBlue",{get:function(){return t._namedColors.deepskyblue.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"DimGray",{get:function(){return t._namedColors.dimgray.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"DodgerBlue",{get:function(){return t._namedColors.dodgerblue.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"FireBrick",{get:function(){return t._namedColors.firebrick.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"FloralWhite",{get:function(){return t._namedColors.floralwhite.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"ForestGreen",{get:function(){return t._namedColors.forestgreen.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"Fuchsia",{get:function(){return t._namedColors.fuchsia.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"Gainsboro",{get:function(){return t._namedColors.gainsboro.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"GhostWhite",{get:function(){return t._namedColors.ghostwhite.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"Gold",{get:function(){return t._namedColors.gold.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"GoldenRod",{get:function(){return t._namedColors.goldenrod.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"Gray",{get:function(){return t._namedColors.gray.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"Green",{get:function(){return t._namedColors.green.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"GreenYellow",{get:function(){return t._namedColors.greenyellow.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"HoneyDew",{get:function(){return t._namedColors.honeydew.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"HotPink",{get:function(){return t._namedColors.hotpink.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"IndianRed",{get:function(){return t._namedColors.indianred.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"Indigo",{get:function(){return t._namedColors.indigo.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"Ivory",{get:function(){return t._namedColors.ivory.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"Khaki",{get:function(){return t._namedColors.khaki.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"Lavender",{get:function(){return t._namedColors.lavender.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"LavenderBlush",{get:function(){return t._namedColors.lavenderblush.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"LawnGreen",{get:function(){return t._namedColors.lawngreen.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"LemonChiffon",{get:function(){return t._namedColors.lemonchiffon.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"LightBlue",{get:function(){return t._namedColors.lightblue.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"LightCoral",{get:function(){return t._namedColors.lightcoral.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"LightCyan",{get:function(){return t._namedColors.lightcyan.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"LightGoldenRodYellow",{get:function(){return t._namedColors.lightgoldenrodyellow.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"LightGray",{get:function(){return t._namedColors.lightgray.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"LightGrey",{get:function(){return t._namedColors.lightgrey.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"LightGreen",{get:function(){return t._namedColors.lightgreen.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"LightPink",{get:function(){return t._namedColors.lightpink.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"LightSalmon",{get:function(){return t._namedColors.lightsalmon.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"LightSeaGreen",{get:function(){return t._namedColors.lightseagreen.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"LightSkyBlue",{get:function(){return t._namedColors.lightskyblue.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"LightSlateGray",{get:function(){return t._namedColors.lightslategray.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"LightSteelBlue",{get:function(){return t._namedColors.lightsteelblue.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"LightYellow",{get:function(){return t._namedColors.lightyellow.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"Lime",{get:function(){return t._namedColors.lime.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"LimeGreen",{get:function(){return t._namedColors.limegreen.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"Linen",{get:function(){return t._namedColors.linen.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"Magenta",{get:function(){return t._namedColors.magenta.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"Maroon",{get:function(){return t._namedColors.maroon.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"MediumAquaMarine",{get:function(){return t._namedColors.mediumaquamarine.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"MediumBlue",{get:function(){return t._namedColors.mediumblue.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"MediumOrchid",{get:function(){return t._namedColors.mediumorchid.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"MediumPurple",{get:function(){return t._namedColors.mediumpurple.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"MediumSeaGreen",{get:function(){return t._namedColors.mediumseagreen.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"MediumSlateBlue",{get:function(){return t._namedColors.mediumslateblue.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"MediumSpringGreen",{get:function(){return t._namedColors.mediumspringgreen.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"MediumTurquoise",{get:function(){return t._namedColors.mediumturquoise.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"MediumVioletRed",{get:function(){return t._namedColors.mediumvioletred.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"MidnightBlue",{get:function(){return t._namedColors.midnightblue.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"MintCream",{get:function(){return t._namedColors.mintcream.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"MistyRose",{get:function(){return t._namedColors.mistyrose.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"Moccasin",{get:function(){return t._namedColors.moccasin.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"NavajoWhite",{get:function(){return t._namedColors.navajowhite.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"Navy",{get:function(){return t._namedColors.navy.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"OldLace",{get:function(){return t._namedColors.oldlace.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"Olive",{get:function(){return t._namedColors.olive.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"OliveDrab",{get:function(){return t._namedColors.olivedrab.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"Orange",{get:function(){return t._namedColors.orange.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"OrangeRed",{get:function(){return t._namedColors.orangered.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"Orchid",{get:function(){return t._namedColors.orchid.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"PaleGoldenRod",{get:function(){return t._namedColors.palegoldenrod.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"PaleGreen",{get:function(){return t._namedColors.palegreen.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"PaleTurquoise",{get:function(){return t._namedColors.paleturquoise.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"PaleVioletRed",{get:function(){return t._namedColors.palevioletred.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"PapayaWhip",{get:function(){return t._namedColors.papayawhip.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"PeachPuff",{get:function(){return t._namedColors.peachpuff.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"Peru",{get:function(){return t._namedColors.peru.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"Pink",{get:function(){return t._namedColors.pink.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"Plum",{get:function(){return t._namedColors.plum.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"PowderBlue",{get:function(){return t._namedColors.powderblue.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"Purple",{get:function(){return t._namedColors.purple.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"Red",{get:function(){return t._namedColors.red.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"RosyBrown",{get:function(){return t._namedColors.rosybrown.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"RoyalBlue",{get:function(){return t._namedColors.royalblue.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"SaddleBrown",{get:function(){return t._namedColors.saddlebrown.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"Salmon",{get:function(){return t._namedColors.salmon.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"SandyBrown",{get:function(){return t._namedColors.sandybrown.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"SeaGreen",{get:function(){return t._namedColors.seagreen.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"SeaShell",{get:function(){return t._namedColors.seashell.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"Sienna",{get:function(){return t._namedColors.sienna.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"Silver",{get:function(){return t._namedColors.silver.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"SkyBlue",{get:function(){return t._namedColors.skyblue.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"SlateBlue",{get:function(){return t._namedColors.slateblue.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"SlateGray",{get:function(){return t._namedColors.slategray.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"Snow",{get:function(){return t._namedColors.snow.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"SpringGreen",{get:function(){return t._namedColors.springgreen.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"SteelBlue",{get:function(){return t._namedColors.steelblue.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"Tan",{get:function(){return t._namedColors.tan.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"Teal",{get:function(){return t._namedColors.teal.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"Thistle",{get:function(){return t._namedColors.thistle.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"Tomato",{get:function(){return t._namedColors.tomato.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"Turquoise",{get:function(){return t._namedColors.turquoise.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"Violet",{get:function(){return t._namedColors.violet.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"Wheat",{get:function(){return t._namedColors.wheat.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"White",{get:function(){return t._namedColors.white.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"WhiteSmoke",{get:function(){return t._namedColors.whitesmoke.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"Yellow",{get:function(){return t._namedColors.yellow.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"YellowGreen",{get:function(){return t._namedColors.yellowgreen.Clone()},enumerable:!0,configurable:!0}),t.prototype.Clone=function(){return new t(this.R,this.G,this.B,this.A)},t.prototype.Dispose=function(){this._onChange.Dispose()},t.prototype.toString=function(){return this._cached===undefined&&(this._cached="rgba("+this.R+","+this.G+","+this.B+","+this.A+")"),this._cached},t.RgbaHexRegExp=/^([a-f\d])([a-f\d])([a-f\d])([a-f\d])$/i,t.RgbRegExp=/^(argb|rgb|rgba)\s*\(\s*([\d+(\.\d+)]{0,3})\s*,\s*([\d]{0,3})\s*,\s*([\d]{0,3})\s*(?:,\s*([\d+(\.\d+)]{0,3})\s*)?\s*\)$/i,t.RgbaRegExp=/^([a-f\d])([a-f\d])([a-f\d])$/i,t._namedColors={transparent:new t(255,255,255,0),aliceblue:new t("#f0f8ff"),antiquewhite:new t("#faebd7"),aqua:new t("#00ffff"),aquamarine:new t("#7fffd4"),azure:new t("#f0ffff"),beige:new t("#f5f5dc"),bisque:new t("#ffe4c4"),black:new t("#000000"),blanchedalmond:new t("#ffebcd"),blue:new t("#0000ff"),blueviolet:new t("#8a2be2"),brown:new t("#a52a2a"),burlywood:new t("#deb887"),cadetblue:new t("#5f9ea0"),chartreuse:new t("#7fff00"),chocolate:new t("#d2691e"),coral:new t("#ff7f50"),cornflowerblue:new t("#6495ed"),cornsilk:new t("#fff8dc"),crimson:new t("#dc143c"),cyan:new t("#00ffff"),darkblue:new t("#00008b"),darkcyan:new t("#008b8b"),darkgoldenrod:new t("#b8860b"),darkgray:new t("#a9a9a9"),darkgreen:new t("#006400"),darkkhaki:new t("#bdb76b"),darkmagenta:new t("#8b008b"),darkolivegreen:new t("#556b2f"),darkorange:new t("#ff8c00"),darkorchid:new t("#9932cc"),darkred:new t("#8b0000"),darksalmon:new t("#e9967a"),darkseagreen:new t("#8fbc8f"),darkslateblue:new t("#483d8b"),darkslategray:new t("#2f4f4f"),darkturquoise:new t("#00ced1"),darkviolet:new t("#9400d3"),deeppink:new t("#ff1493"),deepskyblue:new t("#00bfff"),dimgray:new t("#696969"),dodgerblue:new t("#1e90ff"),firebrick:new t("#b22222"),floralwhite:new t("#fffaf0"),forestgreen:new t("#228b22"),fuchsia:new t("#ff00ff"),gainsboro:new t("#dcdcdc"),ghostwhite:new t("#f8f8ff"),gold:new t("#ffd700"),goldenrod:new t("#daa520"),gray:new t("#808080"),green:new t("#008000"),greenyellow:new t("#adff2f"),honeydew:new t("#f0fff0"),hotpink:new t("#ff69b4"),indianred:new t("#cd5c5c"),indigo:new t("#4b0082"),ivory:new t("#fffff0"),khaki:new t("#f0e68c"),lavender:new t("#e6e6fa"),lavenderblush:new t("#fff0f5"),lawngreen:new t("#7cfc00"),lemonchiffon:new t("#fffacd"),lightblue:new t("#add8e6"),lightcoral:new t("#f08080"),lightcyan:new t("#e0ffff"),lightgoldenrodyellow:new t("#fafad2"),lightgray:new t("#d3d3d3"),lightgrey:new t("#d3d3d3"),lightgreen:new t("#90ee90"),lightpink:new t("#ffb6c1"),lightsalmon:new t("#ffa07a"),lightseagreen:new t("#20b2aa"),lightskyblue:new t("#87cefa"),lightslategray:new t("#778899"),lightsteelblue:new t("#b0c4de"),lightyellow:new t("#ffffe0"),lime:new t("#00ff00"),limegreen:new t("#32cd32"),linen:new t("#faf0e6"),magenta:new t("#ff00ff"),maroon:new t("#800000"),mediumaquamarine:new t("#66cdaa"),mediumblue:new t("#0000cd"),mediumorchid:new t("#ba55d3"),mediumpurple:new t("#9370d8"),mediumseagreen:new t("#3cb371"),mediumslateblue:new t("#7b68ee"),mediumspringgreen:new t("#00fa9a"),mediumturquoise:new t("#48d1cc"),mediumvioletred:new t("#c71585"),midnightblue:new t("#191970"),mintcream:new t("#f5fffa"),mistyrose:new t("#ffe4e1"),moccasin:new t("#ffe4b5"),navajowhite:new t("#ffdead"),navy:new t("#000080"),oldlace:new t("#fdf5e6"),olive:new t("#808000"),olivedrab:new t("#6b8e23"),orange:new t("#ffa500"),orangered:new t("#ff4500"),orchid:new t("#da70d6"),palegoldenrod:new t("#eee8aa"),palegreen:new t("#98fb98"),paleturquoise:new t("#afeeee"),palevioletred:new t("#d87093"),papayawhip:new t("#ffefd5"),peachpuff:new t("#ffdab9"),peru:new t("#cd853f"),pink:new t("#ffc0cb"),plum:new t("#dda0dd"),powderblue:new t("#b0e0e6"),purple:new t("#800080"),red:new t("#ff0000"),rosybrown:new t("#bc8f8f"),royalblue:new t("#4169e1"),saddlebrown:new t("#8b4513"),salmon:new t("#fa8072"),sandybrown:new t("#f4a460"),seagreen:new t("#2e8b57"),seashell:new t("#fff5ee"),sienna:new t("#a0522d"),silver:new t("#c0c0c0"),skyblue:new t("#87ceeb"),slateblue:new t("#6a5acd"),slategray:new t("#708090"),snow:new t("#fffafa"),springgreen:new t("#00ff7f"),steelblue:new t("#4682b4"),tan:new t("#d2b48c"),teal:new t("#008080"),thistle:new t("#d8bfd8"),tomato:new t("#ff6347"),turquoise:new t("#40e0d0"),violet:new t("#ee82ee"),wheat:new t("#f5deb3"),white:new t("#ffffff"),whitesmoke:new t("#f5f5f5"),yellow:new t("#ffff00"),yellowgreen:new t("#9acd32")},t}();t.Color=i})(n.Graphics||(n.Graphics={}));var t=n.Graphics}(EndGate||(EndGate={})),function(n){(function(n){var t=function(t){function i(i,r){var u=this;t.call(this,i),this._type="Shape",this._fillChangeWire=function(n){u._State.FillStyle=n.toString()},this._strokeChangeWire=function(n){u._State.StrokeStyle=n.toString()},this._shadowChangeWire=function(n){u._State.ShadowColor=n.toString()},this.ShadowColor=this._shadowColor=n.Color.Black,this.BorderColor=this._strokeStyle=n.Color.Black,typeof r!="undefined"?(typeof r=="string"&&(r=new n.Color(r)),this.Color=this._fillStyle=r):this.Color=this._fillStyle=n.Color.Black}return __extends(i,t),Object.defineProperty(i.prototype,"Color",{get:function(){return this._fillStyle},set:function(t){typeof t=="string"&&(t=new n.Color(t)),this._fillStyle.OnChange.Unbind(this._fillChangeWire),this._fillStyle=t,this._fillStyle.OnChange.Bind(this._fillChangeWire),this._fillChangeWire(t)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"BorderThickness",{get:function(){return this._State.LineWidth},set:function(n){this._State.LineWidth=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"BorderColor",{get:function(){return this._strokeStyle},set:function(t){typeof t=="string"&&(t=new n.Color(t)),this._strokeStyle.OnChange.Unbind(this._strokeChangeWire),this._strokeStyle=t,this._strokeStyle.OnChange.Bind(this._strokeChangeWire),this._strokeChangeWire(t)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"ShadowColor",{get:function(){return this._shadowColor},set:function(t){typeof t=="string"&&(t=new n.Color(t)),this._shadowColor.OnChange.Unbind(this._shadowChangeWire),this._shadowColor=t,this._shadowColor.OnChange.Bind(this._shadowChangeWire),this._shadowChangeWire(t)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"ShadowX",{get:function(){return this._State.ShadowOffsetX},set:function(n){this._State.ShadowOffsetX=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"ShadowY",{get:function(){return this._State.ShadowOffsetY},set:function(n){this._State.ShadowOffsetY=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"ShadowBlur",{get:function(){return this._State.ShadowBlur},set:function(n){this._State.ShadowBlur=n},enumerable:!0,configurable:!0}),i.prototype.Border=function(n,t){this.BorderThickness=n,this.BorderColor=t},i.prototype.Shadow=function(n,t,i,r){this.ShadowX=n,this.ShadowY=t,this.ShadowColor=i,this.ShadowBlur=r},i.prototype._StartDraw=function(n){t.prototype._StartDraw.call(this,n),n.beginPath()},i.prototype._EndDraw=function(n){n.fill(),this._State.LineWidth>0?n.stroke():n.closePath(),t.prototype._EndDraw.call(this,n)},i.prototype._BuildPath=function(){},i.prototype.Draw=function(n){this._StartDraw(n),this._BuildPath(n),this._EndDraw(n)},i.prototype.Dispose=function(){t.prototype.Dispose.call(this),this._fillStyle.OnChange.Unbind(this._fillChangeWire),this._strokeStyle.OnChange.Unbind(this._strokeChangeWire),this._shadowColor.OnChange.Unbind(this._shadowChangeWire)},i.prototype._Clone=function(n){n.Border(this.BorderThickness,this.BorderColor.Clone()),n.Shadow(this.ShadowX,this.ShadowY,this.ShadowColor.Clone(),this.ShadowBlur),t.prototype._Clone.call(this,n)},i}(n.Graphic2d);n.Shape=t})(n.Graphics||(n.Graphics={}));var t=n.Graphics}(EndGate||(EndGate={})),function(n){(function(n){(function(n){(function(n){n[n.Antiqua=0]="Antiqua",n[n.Arial=1]="Arial",n[n.Avqest=2]="Avqest",n[n.Blackletter=3]="Blackletter",n[n.Calibri=4]="Calibri",n[n.ComicSans=5]="ComicSans",n[n.Courier=6]="Courier",n[n.Decorative=7]="Decorative",n[n.Fraktur=8]="Fraktur",n[n.Frosty=9]="Frosty",n[n.Garamond=10]="Garamond",n[n.Georgia=11]="Georgia",n[n.Helvetica=12]="Helvetica",n[n.Impact=13]="Impact",n[n.Minion=14]="Minion",n[n.Modern=15]="Modern",n[n.Monospace=16]="Monospace",n[n.Palatino=17]="Palatino",n[n.Roman=18]="Roman",n[n.Script=19]="Script",n[n.Swiss=20]="Swiss",n[n.TimesNewRoman=21]="TimesNewRoman",n[n.Verdana=22]="Verdana"})(n.FontFamily||(n.FontFamily={}));var t=n.FontFamily})(n.Assets||(n.Assets={}));var t=n.Assets})(n.Graphics||(n.Graphics={}));var t=n.Graphics}(EndGate||(EndGate={})),function(n){(function(n){(function(n){(function(n){n[n.Normal=0]="Normal",n[n.SmallCaps=1]="SmallCaps"})(n.FontVariant||(n.FontVariant={}));var t=n.FontVariant})(n.Assets||(n.Assets={}));var t=n.Assets})(n.Graphics||(n.Graphics={}));var t=n.Graphics}(EndGate||(EndGate={})),function(n){(function(n){(function(n){(function(n){n[n.Normal=0]="Normal",n[n.Italic=1]="Italic",n[n.Oblique=2]="Oblique"})(n.FontStyle||(n.FontStyle={}));var t=n.FontStyle})(n.Assets||(n.Assets={}));var t=n.Assets})(n.Graphics||(n.Graphics={}));var t=n.Graphics}(EndGate||(EndGate={})),function(n){(function(n){(function(n){var t=function(){function t(){this._cachedState={fontSize:"10px",fontFamily:n.FontFamily.TimesNewRoman,fontVariant:n.FontVariant.Normal,fontWeight:"",fontStyle:n.FontStyle.Normal},this._refreshCache=!0,this._BuildFont()}return Object.defineProperty(t.prototype,"FontSize",{get:function(){return this._cachedState.fontSize},set:function(n){this._refreshCache=!0,this._cachedState.fontSize=n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"FontFamily",{get:function(){return this._cachedState.fontFamily},set:function(n){this._refreshCache=!0,this._cachedState.fontFamily=n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"FontVariant",{get:function(){return this._cachedState.fontVariant},set:function(n){this._refreshCache=!0,this._cachedState.fontVariant=n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"FontWeight",{get:function(){return this._cachedState.fontWeight},set:function(n){this._refreshCache=!0,this._cachedState.fontWeight=n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"FontStyle",{get:function(){return this._cachedState.fontStyle},set:function(n){this._refreshCache=!0,this._cachedState.fontStyle=n},enumerable:!0,configurable:!0}),t.prototype._BuildFont=function(){var t;return this._refreshCache&&(t=this._cachedState.fontWeight+" "+n.FontStyle[this._cachedState.fontStyle].replace("Normal","")+" "+n.FontVariant[this._cachedState.fontVariant].replace("Normal","")+" "+this._cachedState.fontSize,this._cachedState.fontFamily!==undefined&&(t+=" "+n.FontFamily[this._cachedState.fontFamily]),this._cachedFont=t.replace(/^\s\s*/,"").replace(/\s\s*$/,""),this._refreshCache=!1),this._cachedFont},t}();n.FontSettings=t})(n.Assets||(n.Assets={}));var t=n.Assets})(n.Graphics||(n.Graphics={}));var t=n.Graphics}(EndGate||(EndGate={})),function(n){(function(t){var i=function(i){function r(r,u,f,e){typeof e=="undefined"&&(e=t.Color.Black),i.call(this,new n.Vector2d(r,u),e),this._type="Text2d",this._text=f,this._drawBounds=new n.Bounds.BoundingRectangle(this.Position,n.Size2d.One),this._recalculateBoundsSize=!0,this._fontSettings=new t.Assets.FontSettings,this.Align="center",this.Baseline="middle"}return __extends(r,i),Object.defineProperty(r.prototype,"Align",{get:function(){return this._State.TextAlign},set:function(n){this._State.TextAlign=n},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"Baseline",{get:function(){return this._State.TextBaseline},set:function(n){this._State.TextBaseline=n},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"FontSettings",{get:function(){return this._recalculateBoundsSize=!0,this._fontSettings},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"Text",{get:function(){return this._text},set:function(n){this._recalculateBoundsSize=!0,this._text=n},enumerable:!0,configurable:!0}),r.prototype._StartDraw=function(n){n.save(),this._State.SetContextState(n),n.translate(this.Position.X,this.Position.Y),this.Rotation!==0&&n.rotate(this.Rotation)},r.prototype._EndDraw=function(n){for(var i=this.GetChildren(),t=0;t<i.length;t++)i[t].Visible&&i[t].Draw(n);n.restore()},r.prototype.Draw=function(n){var t;this._State.Font=this._fontSettings._BuildFont(),this._StartDraw(n),n.fillText(this._text,0,0),this._State.LineWidth>0&&n.strokeText(this._text,0,0),this._recalculateBoundsSize&&(this._recalculateBoundsSize=!1,t=n.measureText(this._text),this._drawBounds.Size.Width=t.width,this._drawBounds.Size.Height=parseInt(this._fontSettings.FontSize)*1.5),this._EndDraw(n)},r.prototype.GetDrawBounds=function(){return this._drawBounds.Rotation=this.Rotation,this._drawBounds.Position=this.Position,this._drawBounds},r.prototype.Scale=function(n){var t=parseInt(this.FontSettings.FontSize);this.FontSettings.FontSize=this.FontSettings.FontSize.replace(t.toString(),(t*n).toString())},r.prototype.Clone=function(){var n=new r(this.Position.X,this.Position.Y,this.Text,this.Color.Clone());return n.Align=this.Align,n.Baseline=this.Baseline,n.FontSettings.FontFamily=this.FontSettings.FontFamily,n.FontSettings.FontSize=this.FontSettings.FontSize,n.FontSettings.FontStyle=this.FontSettings.FontStyle,n.FontSettings.FontVariant=this.FontSettings.FontVariant,n.FontSettings.FontWeight=this.FontSettings.FontWeight,i.prototype._Clone.call(this,n),n},r}(t.Shape);t.Text2d=i})(n.Graphics||(n.Graphics={}));var t=n.Graphics}(EndGate||(EndGate={})),function(n){(function(t){var i=function(t){function i(i,r,u,f,e){typeof f=="undefined"&&(f=u.ClipSize.Width),typeof e=="undefined"&&(e=u.ClipSize.Height),t.call(this,new n.Vector2d(i,r)),this._type="Sprite2d",this.Image=u,this.Size=new n.Size2d(f,e)}return __extends(i,t),i.prototype.Draw=function(n){t.prototype._StartDraw.call(this,n),n.drawImage(this.Image.Source,this.Image.ClipLocation.X,this.Image.ClipLocation.Y,this.Image.ClipSize.Width,this.Image.ClipSize.Height,-this.Size.HalfWidth,-this.Size.HalfHeight,this.Size.Width,this.Size.Height),t.prototype._EndDraw.call(this,n)},i.prototype.GetDrawBounds=function(){var t=new n.Bounds.BoundingRectangle(this.Position,this.Size);return t.Rotation=this.Rotation,t},i.prototype.Scale=function(n){this.Size.Width*=n,this.Size.Height*=n},i.prototype.Clone=function(){var n=new i(this.Position.X,this.Position.Y,this.Image.Clone(),this.Size.Width,this.Size.Height);return t.prototype._Clone.call(this,n),n},i}(t.Graphic2d);t.Sprite2d=i})(n.Graphics||(n.Graphics={}));var t=n.Graphics}(EndGate||(EndGate={})),function(n){(function(t){var i=function(){function t(t,i,r,u,f){typeof f=="undefined"&&(f=n.Vector2d.Zero);var e=this;this._imageSource=t,this._frameSize=r,this._frameCount=u,this._startOffset=f,this._playing=!1,this._repeating=!1,this._currentFrame=0,this._lastStepAt=0,this._onComplete=new n.EventHandler,this.Fps=i,t.ClipSize!==null||t.IsLoaded()?this._framesPerRow=Math.min(Math.floor((t.ClipSize.Width-f.X)/r.Width),u):(t.OnLoaded.BindFor(function(){e._framesPerRow=Math.min(Math.floor((t.ClipSize.Width-f.X)/r.Width),u)},1),this._framesPerRow=1)}return Object.defineProperty(t.prototype,"OnComplete",{get:function(){return this._onComplete},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Fps",{get:function(){return this._fps},set:function(n){this._fps=n,this._stepEvery=1e3/this._fps},enumerable:!0,configurable:!0}),t.prototype.IsPlaying=function(){return this._playing},t.prototype.CanPlay=function(){return this._imageSource.IsLoaded()},t.prototype.Play=function(n){if(typeof n=="undefined"&&(n=!1),!this._imageSource.ClipSize)throw new Error("Image source not loaded yet.");this._lastStepAt=(new Date).getTime(),this._repeating=n,this._playing=!0,this.UpdateImageSource()},t.prototype.Pause=function(){this._playing=!1},t.prototype.Step=function(n){typeof n=="undefined"&&(n=1),this._currentFrame+=n,this._currentFrame>=this._frameCount&&(this._repeating?this._currentFrame%=this._frameCount:(this._currentFrame=this._frameCount-1,this.OnComplete.Trigger(),this.Stop(!1))),n!==0&&this.UpdateImageSource()},t.prototype.Stop=function(n){typeof n=="undefined"&&(n=!0),this._playing=!1,n&&this.Reset()},t.prototype.Reset=function(){this._currentFrame=0,this.UpdateImageSource()},t.prototype.Update=function(n){var i=n.Now.getTime()-this._lastStepAt,t=0;this._playing&&(t=Math.floor(i/this._stepEvery),t>0&&(this._lastStepAt=n.Now.getTime(),this.Step(t)))},t.prototype.Dispose=function(){this._onComplete.Dispose()},t.prototype.UpdateImageSource=function(){var n=this.GetFrameRow(),t=this.GetFrameColumn();this._imageSource.ClipLocation.X=this._startOffset.X+t*this._frameSize.Width,this._imageSource.ClipLocation.Y=this._startOffset.Y+n*this._frameSize.Height,this._imageSource.ClipSize=this._frameSize},t.prototype.GetFrameRow=function(){return Math.floor(this._currentFrame/this._framesPerRow)},t.prototype.GetFrameColumn=function(){return Math.ceil(this._currentFrame%this._framesPerRow)},t}();t.SpriteAnimation=i})(n.Graphics||(n.Graphics={}));var t=n.Graphics}(EndGate||(EndGate={})),function(n){(function(t){var i=function(t){function i(i,r,u,f){t.call(this,new n.Vector2d(i,r),f),this._type="Circle",this.Radius=u}return __extends(i,t),i.prototype.GetDrawBounds=function(){var t=new n.Bounds.BoundingCircle(this.Position,this.Radius);return t.Rotation=this.Rotation,t},i.prototype.Scale=function(n){this.Radius*=n},i.prototype.Clone=function(){var n=new i(this.Position.X,this.Position.Y,this.Radius,this.Color.Clone());return t.prototype._Clone.call(this,n),n},i.prototype._BuildPath=function(n){n.arc(0,0,this.Radius,0,Math.twoPI)},i}(t.Shape);t.Circle=i})(n.Graphics||(n.Graphics={}));var t=n.Graphics}(EndGate||(EndGate={})),function(n){(function(t){var i=function(t){function i(i,r,u,f,e){t.call(this,new n.Vector2d(i,r),e),this._type="Rectangle",this.Size=new n.Size2d(u,f)}return __extends(i,t),i.prototype.GetDrawBounds=function(){var t=new n.Bounds.BoundingRectangle(this.Position,this.Size);return t.Rotation=this.Rotation,t},i.prototype.Scale=function(n){this.Size.Width*=n,this.Size.Height*=n},i.prototype.Clone=function(){var n=new i(this.Position.X,this.Position.Y,this.Size.Width,this.Size.Height,this.Color.Clone());return t.prototype._Clone.call(this,n),n},i.prototype._BuildPath=function(n){n.rect(-this.Size.HalfWidth,-this.Size.HalfHeight,this.Size.Width,this.Size.Height)},i}(t.Shape);t.Rectangle=i})(n.Graphics||(n.Graphics={}));var t=n.Graphics}(EndGate||(EndGate={})),function(n){(function(t){var i=function(i){function r(r,u,f,e,o,s){typeof o=="undefined"&&(o=1);var h=this;i.call(this,n.Vector2d.Zero),this._type="Line2d",this._from=new n.Vector2d(r,u),this._to=new n.Vector2d(f,e),this.LineWidth=o,this.UpdatePosition(),this._strokeChangeWire=function(n){h._State.StrokeStyle=n.toString()},typeof s!="undefined"?(typeof s=="string"&&(s=new t.Color(s)),this.Color=this._strokeStyle=s):this.Color=this._strokeStyle=t.Color.Black}return __extends(r,i),Object.defineProperty(r.prototype,"From",{get:function(){return this._from},set:function(n){this._from=n,this.UpdatePosition()},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"To",{get:function(){return this._to},set:function(n){this._to=n,this.UpdatePosition()},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"Color",{get:function(){return this._strokeStyle},set:function(n){typeof n=="string"&&(n=new t.Color(n)),this._strokeStyle.OnChange.Unbind(this._strokeChangeWire),this._strokeStyle=n,this._strokeStyle.OnChange.Bind(this._strokeChangeWire),this._strokeChangeWire(n)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"LineWidth",{get:function(){return this._State.LineWidth},set:function(n){this._State.LineWidth=n},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"LineCap",{get:function(){return this._State.LineCap},set:function(n){this._State.LineCap=n},enumerable:!0,configurable:!0}),r.prototype.Draw=function(n){this._strokeStyle.toString()!==this._State.StrokeStyle&&(this._State.StrokeStyle=this._strokeStyle.toString()),i.prototype._StartDraw.call(this,n),this._cachedPosition.Equivalent(this.Position)||this.RefreshCache(),n.beginPath(),n.moveTo(this._from.X-this.Position.X,this._from.Y-this.Position.Y),n.lineTo(this._to.X-this.Position.X,this._to.Y-this.Position.Y),n.stroke(),i.prototype._EndDraw.call(this,n)},r.prototype.GetDrawBounds=function(){var t=new n.Bounds.BoundingRectangle(this.Position,new n.Size2d(this._boundsWidth,this.LineWidth));return t.Rotation=Math.atan2(this._difference.Y,this._difference.X)+this.Rotation,t},r.prototype.Scale=function(n){this.From=this.Position.Add(this.From.Subtract(this.Position).Multiply(n)),this.To=this.Position.Add(this.To.Subtract(this.Position).Multiply(n))},r.prototype.Clone=function(){var n=new r(this.From.X,this.From.Y,this.To.X,this.To.Y,this.LineWidth,this.Color.Clone());return n.LineCap=this.LineCap,i.prototype._Clone.call(this,n),n},r.prototype.Dispose=function(){i.prototype.Dispose.call(this),this._strokeStyle.OnChange.Unbind(this._strokeChangeWire)},r.prototype.UpdatePosition=function(){this.Position=this._from.Add(this._to).Divide(2),this._difference=this._to.Subtract(this._from),this._boundsWidth=this._from.Distance(this._to).Length(),this._cachedPosition=this.Position.Clone()},r.prototype.RefreshCache=function(){var n=this.Position.Subtract(this._cachedPosition);this._from.X+=n.X,this._from.Y+=n.Y,this._to.X+=n.X,this._to.Y+=n.Y,this._cachedPosition=this.Position.Clone()},r}(t.Graphic2d);t.Line2d=i})(n.Graphics||(n.Graphics={}));var t=n.Graphics}(EndGate||(EndGate={})),function(n){(function(t){var i=function(i){function r(r,u,f,e,o,s,h,c){var l,a;for(typeof h=="undefined"&&(h=!1),typeof c=="undefined"&&(c=new t.Color("gray")),i.call(this,new n.Vector2d(r,u)),this._type="Grid",this._size=new n.Size2d(o*e,s*f),this._tileSize=new n.Size2d(o,s),this._grid=[],this._rows=f,this._columns=e,this._gridLines=[],this.GridLineColor=c,this.DrawGridLines=h,l=0;l<this._rows;l++)for(this._grid[l]=[],a=0;a<this._columns;a++)this._grid[l].push(null)}return __extends(r,i),Object.defineProperty(r.prototype,"DrawGridLines",{get:function(){return this._drawGridLines},set:function(n){n&&this._gridLines.length===0&&this.BuildGridLines(),this._drawGridLines=n},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"GridLineColor",{get:function(){return this._gridLineColor},set:function(n){typeof n=="string"&&(n=new t.Color(n)),this._gridLineColor=n;for(var i=0;i<this._gridLines.length;i++)this._gridLines[i].Color=n},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"Size",{get:function(){return this._size.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"TileSize",{get:function(){return this._tileSize.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"Rows",{get:function(){return this._rows},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"Columns",{get:function(){return this._columns},enumerable:!0,configurable:!0}),r.prototype.Fill=function(n,t,i){i&&this.ValidRow(n)&&this.ValidColumn(t)&&(i.Position=this.GetInsideGridPosition(n,t),this._grid[n][t]=i,this.AddChild(i))},r.prototype.FillRow=function(n,t,i){var u,r;for(typeof i=="undefined"&&(i=0),r=0;r<t.length;r++)u=t[r],u.Position=this.GetInsideGridPosition(n,r+i),this._grid[n][r+i]=u,this.AddChild(u)},r.prototype.FillColumn=function(n,t,i){var u,r;for(typeof i=="undefined"&&(i=0),r=0;r<t.length;r++)u=t[r],u.Position=this.GetInsideGridPosition(r+i,n),this._grid[r+i][n]=u,this.AddChild(u)},r.prototype.FillSpace=function(n,t,i){for(var f,u,r=0;r<i.length;r++)for(u=0;u<i[r].length;u++)f=i[r][u],f&&(f.Position=this.GetInsideGridPosition(r+n,u+t),this._grid[r+n][u+t]=f,this.AddChild(f))},r.prototype.Get=function(n,t){return!this.ValidRow(n)||!this.ValidColumn(t)?null:this._grid[n][t]},r.prototype.GetRow=function(n,t){var r,i;for(typeof t=="undefined"&&(t=0),r=[],i=t;i<this._columns;i++)r.push(this._grid[n][i]);return r},r.prototype.GetColumn=function(n,t){var r,i;for(typeof t=="undefined"&&(t=0),r=[],i=t;i<this._rows;i++)r.push(this._grid[i][n]);return r},r.prototype.GetSpace=function(n,t,i,r){for(var e=[],o=i>=n?1:-1,s=r>=t?1:-1,f,u=n;u!==i+o;u+=o){if(u>=this._rows)break;for(f=t;f!==r+s;f+=s){if(f>=this._columns)break;e.push(this._grid[u][f])}}return e},r.prototype.Clear=function(n,t){if(!this.ValidRow(n)||!this.ValidColumn(t))return null;var i=this._grid[n][t];return this._grid[n][t]=null,this.RemoveChild(i),i},r.prototype.ClearRow=function(n,t){var r,i;for(typeof t=="undefined"&&(t=0),r=[],i=0;i<this._columns;i++)r.push(this._grid[n][i]),this.RemoveChild(this._grid[n][i]),this._grid[n][i]=null;return r},r.prototype.ClearColumn=function(n,t){var r,i;for(typeof t=="undefined"&&(t=0),r=[],i=0;i<this._rows;i++)r.push(this._grid[i][n]),this.RemoveChild(this._grid[i][n]),this._grid[i][n]=null;return r},r.prototype.ClearSpace=function(n,t,i,r){for(var e=[],o=i>=n?1:-1,s=r>=t?1:-1,f,u=n;u!==i+o;u+=o){if(u>this._rows)break;for(f=t;f!==r+s;f+=s){if(f>this._columns)break;e.push(this._grid[u][f]),this.RemoveChild(this._grid[u][f]),this._grid[u][f]=null}}return e},r.prototype.Draw=function(n){if(i.prototype._StartDraw.call(this,n),n.save(),i.prototype._EndDraw.call(this,n),this.DrawGridLines)for(var t=0;t<this._gridLines.length;t++)this._gridLines[t].Draw(n);n.restore()},r.prototype.GetDrawBounds=function(){var t=new n.Bounds.BoundingRectangle(this.Position,this._size);return t.Rotation=this.Rotation,t},r.prototype.Scale=function(){throw new Error("Scale is not implemented for the Grid class.");},r.prototype.ConvertToRow=function(n){return Math.floor((n-(this.Position.Y-this._size.HalfHeight))/this._tileSize.Height)},r.prototype.ConvertToColumn=function(n){return Math.floor((n-(this.Position.X-this._size.HalfWidth))/this._tileSize.Width)},r.prototype.Clone=function(){for(var t=new r(this.Position.X,this.Position.Y,this._rows,this._columns,this._tileSize.Width,this._tileSize.Height,this._drawGridLines,this._gridLineColor.Clone()),i,n=0;n<this._grid.length;n++)for(i=0;i<this._grid[n].length;i++)this._grid[n][i]&&t.Fill(n,i,this._grid[n][i].Clone());return t.Opacity=this.Opacity,t.Rotation=this.Rotation,t.Visible=this.Visible,t.ZIndex=this.ZIndex,t},r.prototype.BuildGridLines=function(){for(var e=this._size.Multiply(.5),i=new n.Vector2d(-e.Width,-e.Height),r=new n.Vector2d(e.Width,e.Height),f,u=0;u<this._rows;u++)if(this._gridLines.push(new t.Line2d(i.X,i.Y+u*this._tileSize.Height,r.X,i.Y+u*this._tileSize.Height,1,this._gridLineColor)),u===0)for(f=0;f<this._columns;f++)this._gridLines.push(new t.Line2d(i.X+f*this._tileSize.Width,i.Y,i.X+f*this._tileSize.Width,r.Y,1,this._gridLineColor));this._gridLines.push(new t.Line2d(i.X,r.Y,r.X,r.Y,1)),this._gridLines.push(new t.Line2d(r.X,i.Y,r.X,r.Y,1))},r.prototype.GetInsideGridPosition=function(t,i){return new n.Vector2d(i*this._tileSize.Width-this._size.HalfWidth+this._tileSize.HalfWidth,t*this._tileSize.Height-this._size.HalfHeight+this._tileSize.HalfHeight)},r.prototype.ValidRow=function(n){return n>=0&&n<this._rows},r.prototype.ValidColumn=function(n){return n>=0&&n<this._columns},r}(t.Graphic2d);t.Grid=i})(n.Graphics||(n.Graphics={}));var t=n.Graphics}(EndGate||(EndGate={})),function(n){var t=function(){function t(n,t,i,r){typeof n=="undefined"&&(n=0),typeof t=="undefined"&&(t=0),typeof i=="undefined"&&(i=0),typeof r=="undefined"&&(r=0),this._type="Matrix2x2",this.Values=[[n,t],[i,r]]}return Object.defineProperty(t,"Zero",{get:function(){return new t},enumerable:!0,configurable:!0}),Object.defineProperty(t,"Identity",{get:function(){return new t(1,0,0,1)},enumerable:!0,configurable:!0}),t.prototype.Apply=function(n){this.Values[0][0]=n(this.Values[0][0]),this.Values[0][1]=n(this.Values[0][1]),this.Values[1][0]=n(this.Values[1][0]),this.Values[1][1]=n(this.Values[1][1])},t.prototype.Trigger=function(n){n(this.Values[0][0]),n(this.Values[0][1]),n(this.Values[1][0]),n(this.Values[1][1])},t.prototype.Add=function(n){return n._type==="Matrix2x2"?new t(this.Values[0][0]+n.Values[0][0],this.Values[0][1]+n.Values[0][1],this.Values[1][0]+n.Values[1][0],this.Values[1][1]+n.Values[1][1]):new t(this.Values[0][0]+n,this.Values[0][1]+n,this.Values[1][0]+n,this.Values[1][1]+n)},t.prototype.Multiply=function(n){return n._type==="Matrix2x2"?new t(this.Values[0][0]*n.Values[0][0]+this.Values[0][1]*n.Values[1][0],this.Values[0][0]*n.Values[0][1]+this.Values[0][1]*n.Values[1][1],this.Values[1][0]*n.Values[0][0]+this.Values[1][1]*n.Values[1][0],this.Values[1][0]*n.Values[0][1]+this.Values[1][1]*n.Values[1][1]):new t(this.Values[0][0]*n,this.Values[0][1]*n,this.Values[1][0]*n,this.Values[1][1]*n)},t.prototype.Subtract=function(n){return n._type==="Matrix2x2"?new t(this.Values[0][0]-n.Values[0][0],this.Values[0][1]-n.Values[0][1],this.Values[1][0]-n.Values[1][0],this.Values[1][1]-n.Values[1][1]):new t(this.Values[0][0]-n,this.Values[0][1]-n,this.Values[1][0]-n,this.Values[1][1]-n)},t.prototype.SubtractFrom=function(n){return n._type==="Matrix2x2"?new t(n.Values[0][0]-this.Values[0][0],n.Values[0][1]-this.Values[0][1],n.Values[1][0]-this.Values[1][0],n.Values[1][1]-this.Values[1][1]):new t(n-this.Values[0][0],n-this.Values[0][1],n-this.Values[1][0],n-this.Values[1][1])},t.prototype.Divide=function(n){return n._type==="Matrix2x2"?new t(this.Values[0][0]/n.Values[0][0],this.Values[0][1]/n.Values[0][1],this.Values[1][0]/n.Values[1][0],this.Values[1][1]/n.Values[1][1]):new t(this.Values[0][0]/n,this.Values[0][1]/n,this.Values[1][0]/n,this.Values[1][1]/n)},t.prototype.DivideFrom=function(n){return n._type==="Matrix2x2"?new t(n.Values[0][0]/this.Values[0][0],n.Values[0][1]/this.Values[0][1],n.Values[1][0]/this.Values[1][0],n.Values[1][1]/this.Values[1][1]):new t(n/this.Values[0][0],n/this.Values[0][1],n/this.Values[1][0],n/this.Values[1][1])},t.prototype.Transform=function(t){return new n.Vector2d(this.Values[0][0]*t.X+this.Values[0][1]*t.Y,this.Values[1][0]*t.X+this.Values[1][1]*t.Y)},t.prototype.Transpose=function(){return new t(this.Values[0][0],this.Values[1][0],this.Values[0][1],this.Values[1][1])},t.prototype.Determinant=function(){return this.Values[0][0]*this.Values[1][1]-this.Values[0][1]*this.Values[1][0]},t.prototype.Inverse=function(){return new t(this.Values[1][1],-this.Values[0][1],-this.Values[1][0],this.Values[0][0]).Multiply(1/this.Determinant())},t.prototype.Clone=function(){return new t(this.Values[0][0],this.Values[0][1],this.Values[1][0],this.Values[1][1])},t.prototype.Equivalent=function(n){return this.Values[0][0]===n.Values[0][0]&&this.Values[0][1]===n.Values[0][1]&&this.Values[1][0]===n.Values[1][0]&&this.Values[1][1]===n.Values[1][1]},t.prototype.toString=function(){return this.Values[0].toString()+" "+this.Values[1].toString()},t.Scale=function(n){return new t(n.X,0,0,n.Y)},t}();n.Matrix2x2=t}(EndGate||(EndGate={})),function(n){(function(t){var i=function(t){function i(i,r,u){t.call(this,new n.Vector2d(i,r)),this._Resources=u}return __extends(i,t),i.prototype.Scale=function(){throw new Error("Scale is not implemented for TileMaps.");},i}(n.Graphics.Graphic2d);t.TileMap=i})(n.Graphics||(n.Graphics={}));var t=n.Graphics}(EndGate||(EndGate={})),function(n){(function(t){(function(t){var i=function(n){function t(t,i,r){n.call(this,0,0,t,i,r)}return __extends(t,n),t}(n.Graphics.Sprite2d);t.SquareTile=i})(t.Assets||(t.Assets={}));var i=t.Assets})(n.Graphics||(n.Graphics={}));var t=n.Graphics}(EndGate||(EndGate={})),function(n){(function(t){var i=function(i){function r(t,r,u,f,e,o,s,h){typeof s=="undefined"&&(s=!0),typeof h=="undefined"&&(h=!1);var c=this;i.call(this,t,r,e),this._mappings=o,this._grid=new n.Graphics.Grid(0,0,o.length,o[0].length,u,f,h),this._staticMap=s,this._onTileLoad=new n.EventHandler2,this._onLoaded=new n.EventHandler,this._loaded=!1,this._tilesBuilt=0,this._totalTiles=this._grid.Rows*this._grid.Columns,this.TileLoadDelay=n.TimeSpan.Zero,this.RowLoadDelay=n.TimeSpan.Zero,this._staticMap&&this.BuildCache(),setTimeout(function(){c.FillGridWith(o,function(){c._loaded=!0,c._onLoaded.Trigger()})},0)}return __extends(r,i),Object.defineProperty(r.prototype,"OnTileLoad",{get:function(){return this._onTileLoad},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"OnLoaded",{get:function(){return this._onLoaded},enumerable:!0,configurable:!0}),r.ExtractTiles=function(n,t,i){for(var f=[],e=Math.floor(n.ClipSize.Width/t),o=Math.floor(n.ClipSize.Height/i),u,r=0;r<o;r++)for(u=0;u<e;u++)f.push(n.Extract(u*t,r*i,t,i));return f},r.prototype.IsLoaded=function(){return this._loaded},r.prototype.Draw=function(n){i.prototype._StartDraw.call(this,n),this._staticMap?n.drawImage(this._mapCache,-this._mapCache.width/2,-this._mapCache.height/2):this._grid.Draw(n),i.prototype._EndDraw.call(this,n)},r.prototype.GetDrawBounds=function(){var n=this._grid.GetDrawBounds();return n.Position=this.Position,n},r.prototype.Dispose=function(){this._grid.Dispose(),this._onLoaded.Dispose(),this._onTileLoad.Dispose(),i.prototype.Dispose.call(this)},r.prototype.Clone=function(){var n=new r(this.Position.X,this.Position.Y,this._grid.TileSize.Width,this._grid.TileSize.Height,this._Resources,this._mappings);return n.Opacity=this.Opacity,n.Rotation=this.Rotation,n.Visible=this.Visible,n.ZIndex=this.ZIndex,n.RowLoadDelay=this.RowLoadDelay.Clone(),n.TileLoadDelay=this.TileLoadDelay.Clone(),n},r.prototype.BuildCache=function(){var n=this._grid.Size,t=this._grid.Position;this._mapCache=document.createElement("canvas"),this._mapCache.width=n.Width,this._mapCache.height=n.Height,this._mapCacheContext=this._mapCache.getContext("2d"),this._mapCacheContext.translate(n.HalfWidth,n.HalfHeight)},r.prototype.CacheTile=function(n){n.Draw(this._mapCacheContext)},r.prototype.FillGridWith=function(n,t){var i=this;asyncLoop(function(t,r){i.AsyncBuildGridRow(r,n,function(){t()})},n.length,function(){t()})},r.prototype.AsyncBuildGridTile=function(n,i,r,u){var f=this,e=function(){var e,o=f._Resources[r];e=new t.Assets.SquareTile(o,f._grid.TileSize.Width,f._grid.TileSize.Height),f._grid.Fill(n,i,e),f.OnTileLoad.Trigger({Tile:e,Row:n,Column:i,ResourceIndex:r,Parent:f},f._tilesBuilt/f._totalTiles),f._staticMap&&f.CacheTile(e),u(e)};this.TileLoadDelay.Milliseconds>0?setTimeout(e,this.TileLoadDelay.Milliseconds):e()},r.prototype.AsyncBuildGridRow=function(n,t,i){var r=this;setTimeout(function(){asyncLoop(function(i,u){r._tilesBuilt++,t[n][u]>=0?r.AsyncBuildGridTile(n,u,t[n][u],function(){i()}):i()},t[n].length,function(){i()})},this.RowLoadDelay.Milliseconds)},r}(t.TileMap);t.SquareTileMap=i})(n.Graphics||(n.Graphics={}));var t=n.Graphics}(EndGate||(EndGate={})),eg=EndGate,Number.prototype.Clone=function(){return this},function(n){(function(n){(function(n){n[n.TMX=0]="TMX"})(n.JSONFormat||(n.JSONFormat={}));var t=n.JSONFormat})(n.MapLoaders||(n.MapLoaders={}));var t=n.MapLoaders}(EndGate||(EndGate={})),function(n){(function(t){(function(t){(function(t){var i=function(){function t(){}return t.prototype.Load=function(i,r,u){var s=this,f=0,h=0,e=new n.EventHandler1,o;for(this.LoadTilesetSources(i.tilesets,function(){f+=1/i.tilesets.length*t._imagePercentMax,e.Trigger(f)},function(n){var c=s.ExtractTilesetTiles(i.tilesets,n,r),o=[],h=(1-t._imagePercentMax)/i.layers.length;f=t._imagePercentMax,asyncLoop(function(n,t){if(i.layers[t].type!=="tilelayer")throw new Error("Invalid layer type.  The layer type '"+i.layers[t].type+"' is not supported.");s.AsyncBuildLayer(i,t,r,c,function(n,t){e.Trigger(f+t*h)},function(t){f+=h,e.Trigger(f),o.push(t),n()})},i.layers.length,function(){u({Layers:o})})}),o=0;o<i.layers.length;o++)h+=i.layers[o].data.length;return{TileCount:h,LayerCount:i.layers.length,ResourceSheetCount:i.tilesets.length,OnPercentLoaded:e}},t.prototype.LoadTilesetSources=function(t,i,r){for(var f={},e=0,o=function(n){i(n),++e===t.length&&r(f)},u=0;u<t.length;u++)f[t[u].name]=new n.Graphics.ImageSource(t[u].image,t[u].imagewidth,t[u].imageheight),f[t[u].name].OnLoaded.Bind(o)},t.prototype.ExtractTilesetTiles=function(t,i,r){var c=[],e=[],l,s,u,o,h,f;for(t.sort(function(n,t){return n.firstgid-t.firstgid}),u=0;u<t.length;u++){l=n.Graphics.SquareTileMap.ExtractTiles(i[t[u].name],t[u].tilewidth,t[u].tileheight);for(f in t[u].properties)if(typeof r.ResourceSheetHooks[f]!="undefined")for(o=t[u].firstgid-1;o<t[u].firstgid-1+l.length;o++)typeof e[o]=="undefined"&&(e[o]=[]),e[o].push(this.BuildHookerFunction(t[u].properties[f],r.ResourceSheetHooks[f]));for(h in t[u].tileproperties)for(f in t[u].tileproperties[h])typeof r.ResourceTileHooks[f]!="undefined"&&(s=parseInt(h)+t[u].firstgid-1,typeof e[s]=="undefined"&&(e[s]=[]),e[s].push(this.BuildHookerFunction(t[u].tileproperties[h][f],r.ResourceTileHooks[f])));c=c.concat(l)}return{Resources:c,ResourceHooks:e}},t.prototype.AsyncBuildLayer=function(t,i,r,u,f,e){var o=this;setTimeout(function(){var s=t.layers[i],a=o.NormalizeLayerData(s.data,t.width),h=new n.Graphics.SquareTileMap(s.x,s.y,t.tilewidth,t.tileheight,u.Resources,a),l=[],c;for(c in s.properties)typeof r.LayerHooks[c]!="undefined"&&l.push(o.BuildHookerFunction(s.properties[c],r.LayerHooks[c]));h.ZIndex=i,h.Visible=s.visible,h.Opacity=s.opacity,h.RowLoadDelay=n.TimeSpan.FromMilliseconds(5),h.OnTileLoad.Bind(function(n,t){var i;if(u.ResourceHooks[n.ResourceIndex])for(i=0;i<u.ResourceHooks[n.ResourceIndex].length;i++)u.ResourceHooks[n.ResourceIndex][i](n);for(i=0;i<l.length;i++)l[i](n);f(n,t)}),h.OnLoaded.Bind(function(){e(h)})},0)},t.prototype.BuildHookerFunction=function(n,t){return function(i){return t(i,n)}},t.prototype.NormalizeLayerData=function(n,t){for(var r=[],u,i=0;i<n.length;i++)u=Math.floor(i/t),r[u]instanceof Array||(r[u]=[]),r[u].push(n[i]-1);return r},t._imagePercentMax=.2,t}();t.OrthogonalLoader=i})(t.TMX||(t.TMX={}));var i=t.TMX})(t._||(t._={}));var i=t._})(n.MapLoaders||(n.MapLoaders={}));var t=n.MapLoaders}(EndGate||(EndGate={})),function(n){(function(n){(function(n){(function(n){var t=function(){function t(){this._orientationLoaders={orthogonal:new n.OrthogonalLoader}}return t.prototype.Load=function(n,t,i){if(!this._orientationLoaders[n.orientation])throw new Error("Invalid orientation.  The orientation '"+n.orientation+"' is not supported.");return this._orientationLoaders[n.orientation].Load(n,t,i)},t}();n.TMXLoader=t})(n.TMX||(n.TMX={}));var t=n.TMX})(n._||(n._={}));var t=n._})(n.MapLoaders||(n.MapLoaders={}));var t=n.MapLoaders}(EndGate||(EndGate={})),function(n){(function(n){var t=function(){function t(){}return t.Load=function(i,r,u,f){return typeof f=="undefined"&&(f=n.JSONFormat.TMX),u||(u={ResourceTileHooks:{},ResourceSheetHooks:{},LayerHooks:{}}),t._loaders[n.JSONFormat[f]].Load(i,u,r)},t._loaders={TMX:new n._.TMX.TMXLoader},t}();n.JSONLoader=t})(n.MapLoaders||(n.MapLoaders={}));var t=n.MapLoaders}(EndGate||(EndGate={})),function(n){(function(t){var i=function(){function t(n,t){typeof t=="undefined"&&(t=n),this.Min=n,this.Max=t}return t.prototype.Clone=function(){return new t(this.Min,this.Max)},t.RandomNumber=function(n){return Math.random()*(n.Max-n.Min)+n.Min},t.RandomTimeSpan=function(t){return n.TimeSpan.FromMilliseconds(Math.floor(Math.random()*(t.Max.Milliseconds-t.Min.Milliseconds+1)+t.Min.Milliseconds))},t}();t.Range=i})(n.Particles||(n.Particles={}));var t=n.Particles}(EndGate||(EndGate={})),function(n){(function(n){(function(n){var t=function(){function n(){}return Object.defineProperty(n,"EaseNone",{get:function(){return n._easeNone},enumerable:!0,configurable:!0}),n._easeNone=function(n,t,i,r){var u=t-n;return u*i.Milliseconds/r.Milliseconds+n},n}();n.Linear=t})(n.Functions||(n.Functions={}));var t=n.Functions})(n.Tweening||(n.Tweening={}));var t=n.Tweening}(EndGate||(EndGate={})),function(n){(function(t){var i=function(){function t(t,i,r,u){this._from=t.Clone(),this._to=i.Clone(),this._current=this._from.Clone(),this._duration=r,this._elapsed=n.TimeSpan.Zero,this._playing=!1,this._onChange=new n.EventHandler1,this._onComplete=new n.EventHandler1,this._tweeningFunction=u}return Object.defineProperty(t.prototype,"OnChange",{get:function(){return this._onChange},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"OnComplete",{get:function(){return this._onComplete},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"From",{get:function(){return this._from},set:function(n){this._from=n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"To",{get:function(){return this._to},set:function(n){this._to=n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Current",{get:function(){return this._current},set:function(n){this._current=n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Duration",{get:function(){return this._duration},set:function(n){this._duration=n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Elapsed",{get:function(){return this._elapsed.Clone()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"TweeningFunction",{get:function(){return this._tweeningFunction},set:function(n){this._tweeningFunction=n},enumerable:!0,configurable:!0}),t.prototype.IsPlaying=function(){return this._playing},t.prototype.Play=function(){this._playing=!0},t.prototype.Pause=function(){this._playing=!1},t.prototype.Reset=function(){this._elapsed.Milliseconds=0,this._current=this._from.Clone()},t.prototype.Stop=function(){this._playing=!1,this.Reset()},t.prototype.Restart=function(){this.Reset(),this.Play()},t.prototype.Reverse=function(){this._elapsed=n.TimeSpan.Zero,this._to=this._from,this._from=this.Current.Clone()},t.prototype.Update=function(n){this._playing&&(this._elapsed=this._elapsed.Add(n.Elapsed),this._elapsed.Milliseconds>=this._duration.Milliseconds?(this._elapsed=this._duration.Clone(),this._current=this._to.Clone(),this._playing=!1,this._onChange.Trigger(this._current.Clone()),this._onComplete.Trigger(this)):(this._UpdateTween(),this._onChange.Trigger(this._current.Clone())))},t.prototype.Dispose=function(){this.Stop(),this._onChange.Dispose(),this._onComplete.Dispose()},t.prototype._UpdateTween=function(){},t}();t.Tween=i})(n.Tweening||(n.Tweening={}));var t=n.Tweening}(EndGate||(EndGate={})),function(n){(function(t){var i=function(t){function i(n,i,r,u){t.call(this,n,i,r,u)}return __extends(i,t),i.prototype._UpdateTween=function(){this.Current=new n.Vector2d(this.TweeningFunction(this.From.X,this.To.X,this.Elapsed,this.Duration),this.TweeningFunction(this.From.Y,this.To.Y,this.Elapsed,this.Duration))},i}(t.Tween);t.Vector2dTween=i})(n.Tweening||(n.Tweening={}));var t=n.Tweening}(EndGate||(EndGate={})),function(n){(function(n){var t=function(n){function t(t,i,r,u){n.call(this,t,i,r,u)}return __extends(t,n),t.prototype._UpdateTween=function(){this.Current=this.TweeningFunction(this.From,this.To,this.Elapsed,this.Duration)},t}(n.Tween);n.NumberTween=t})(n.Tweening||(n.Tweening={}));var t=n.Tweening}(EndGate||(EndGate={})),function(n){(function(t){var i=function(){function t(t,i,r,u,f,e,o,s,h,c,l){t.Position=i,t.Scale(u),t.Rotation=e,t.Opacity=0,this._texture=t,this._rotationSpeed=o,this._alive=!0,this._fadingOut=!1,this._lifetime=s,this._createdAt=(new Date).getTime(),this._onDeath=new n.EventHandler1,this._fadeOutDuration=c,this._fadeOutAt=s.Milliseconds-c.Milliseconds,this._locationTween=new n.Tweening.Vector2dTween(t.Position,r,s,l),this._fadeTween=new n.Tweening.NumberTween(0,f*100,h,n.Tweening.Functions.Linear.EaseNone),this._locationTween.Play(),this._fadeTween.Play()}return Object.defineProperty(t.prototype,"Texture",{get:function(){return this._texture},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"OnDeath",{get:function(){return this._onDeath},enumerable:!0,configurable:!0}),t.prototype.IsAlive=function(){return this._alive},t.prototype.Update=function(n){var t;this._alive&&(t=n.Now.getTime()-this._createdAt,t>this._lifetime.Milliseconds?(this._alive=!1,this._onDeath.Trigger(this)):(!this._fadingOut&&t>=this._fadeOutAt&&(this._fadingOut=!0,this._fadeTween.From=this._texture.Opacity*100,this._fadeTween.To=0,this._fadeTween.Duration=this._fadeOutDuration,this._fadeTween.Restart()),this._locationTween.Update(n),this._fadeTween.Update(n),this._texture.Rotation+=n.Elapsed.Seconds*this._rotationSpeed,this._texture.Position=this._locationTween.Current,this._texture.Opacity=this._fadeTween.Current/100))},t}();t.Particle=i})(n.Particles||(n.Particles={}));var t=n.Particles}(EndGate||(EndGate={})),function(n){(function(t){var i=function(i){function r(r,u,f){var e=this;i.call(this,new n.Vector2d(r,u)),this.EmissionInterval=new t.Range(n.TimeSpan.FromMilliseconds(30)),this.EmissionDirection=new t.Range(0,Math.PI*2),this.EmissionOutput=new t.Range(1),this.ParticleLifetime=new t.Range(n.TimeSpan.FromSeconds(1),n.TimeSpan.FromSeconds(3)),this.ParticleSpeed=new t.Range(30,100),this.ParticleScale=new t.Range(.75,1.5),this.ParticleRotation=new t.Range(0,Math.PI*2),this.ParticleRotationSpeed=new t.Range(0,Math.PI),this.ParticleOpacity=new t.Range(1),this.ParticleFadeInDuration=new t.Range(n.TimeSpan.FromSeconds(.5)),this.ParticleFadeOutDuration=new t.Range(n.TimeSpan.FromSeconds(.5),n.TimeSpan.FromSeconds(1)),this._texturePool=[],this._particlePool={},this._particleId=0,this._emitting=!1,this._particleRemover=function(n){e.RemoveChild(n.Texture),delete e._particlePool[n._id]},this.EmissionFunction=f}return __extends(r,i),r.prototype.IsEmitting=function(){return this._emitting},r.prototype.Start=function(){if(this._texturePool.length===0)throw new Error("Cannot start Emitter without any textures added to it.");this._emitting=!0,this._lastEmit=(new Date).getTime()},r.prototype.Stop=function(){this._emitting=!1},r.prototype.AddTexture=function(n,t){typeof t=="undefined"&&(t=1);for(var i=0;i<t;i++)this._texturePool.push(n)},r.prototype.RemoveTexture=function(n){for(var t=0;t<this._texturePool.length;t++)this._texturePool[t]===n&&this._texturePool.splice(t--,1)},r.prototype.Emit=function(){for(var h=t.Range.RandomNumber(this.EmissionOutput),f,e,o,r,i,s=[],u=0;u<h;u++)r=t.Range.RandomTimeSpan(this.ParticleLifetime),o=t.Range.RandomNumber(this.ParticleSpeed),e=t.Range.RandomNumber(this.EmissionDirection),f=new n.Vector2d(r.Seconds*o,0).RotateAround(n.Vector2d.Zero,e),i=new t.Particle(this.BuildTextureFromPool(),n.Vector2d.Zero,f,t.Range.RandomNumber(this.ParticleScale),t.Range.RandomNumber(this.ParticleOpacity),t.Range.RandomNumber(this.ParticleRotation),t.Range.RandomNumber(this.ParticleRotationSpeed),r,t.Range.RandomTimeSpan(this.ParticleFadeInDuration),t.Range.RandomTimeSpan(this.ParticleFadeOutDuration),this.EmissionFunction),i._id=this._particleId++,this._particlePool[i._id]=i,this.AddChild(i.Texture),i.OnDeath.Bind(this._particleRemover),s.push(i);return s},r.prototype.Draw=function(n){i.prototype._StartDraw.call(this,n),i.prototype._EndDraw.call(this,n)},r.prototype.Scale=function(){throw new Error("Scale is not implemented for the Emitter class.");},r.prototype.Update=function(n){var f,i,r,u,e;if(this._emitting){if(r=t.Range.RandomTimeSpan(this.EmissionInterval).Milliseconds,r>0&&(f=n.Now.getTime()-this._lastEmit,i=Math.floor(f/r),i>0))for(this._lastEmit=n.Now.getTime(),u=0;u<i;u++)this.Emit();for(e in this._particlePool)this._particlePool[e].Update(n)}},r.prototype.GetDrawBounds=function(){return new n.Bounds.BoundingCircle(this.Position,this.ParticleSpeed.Max*this.ParticleLifetime.Max.Seconds)},r.prototype.Clone=function(){for(var n=new r(this.Position.X,this.Position.Y,this.EmissionFunction),t=0;t<this._texturePool.length;t++)n.AddTexture(this._texturePool[t]);return n.EmissionInterval=this.EmissionInterval.Clone(),n.EmissionDirection=this.EmissionDirection.Clone(),n.EmissionOutput=this.EmissionOutput.Clone(),n.ParticleLifetime=this.ParticleLifetime.Clone(),n.ParticleSpeed=this.ParticleSpeed.Clone(),n.ParticleRotation=this.ParticleRotation.Clone(),n.ParticleRotationSpeed=this.ParticleRotationSpeed.Clone(),n.ParticleFadeInDuration=this.ParticleFadeInDuration.Clone(),n.ParticleFadeOutDuration=this.ParticleFadeOutDuration.Clone(),n.ParticleScale=this.ParticleScale.Clone(),n.ParticleOpacity=this.ParticleOpacity.Clone(),n.Opacity=this.Opacity,n.Rotation=this.Rotation,n.Visible=this.Visible,n.ZIndex=this.ZIndex,n},r.prototype.BuildTextureFromPool=function(){var n=Math.floor(Math.random()*this._texturePool.length);return this._texturePool[n].Clone()},r}(n.Graphics.Graphic2d);t.Emitter=i})(n.Particles||(n.Particles={}));var t=n.Particles}(EndGate||(EndGate={})),function(n){(function(n){var t=function(n){function t(t,i,r,u){n.call(this,t,i,r,u)}return __extends(t,n),t.prototype._UpdateTween=function(){this.Current.R=this.TweeningFunction(this.From.R,this.To.R,this.Elapsed,this.Duration),this.Current.G=this.TweeningFunction(this.From.G,this.To.G,this.Elapsed,this.Duration),this.Current.B=this.TweeningFunction(this.From.B,this.To.B,this.Elapsed,this.Duration)},t}(n.Tween);n.ColorTween=t})(n.Tweening||(n.Tweening={}));var t=n.Tweening}(EndGate||(EndGate={})),function(n){(function(t){var i=function(t){function i(n,i,r,u){t.call(this,n,i,r,u)}return __extends(i,t),i.prototype._UpdateTween=function(){this.Current=new n.Size2d(this.TweeningFunction(this.From.Width,this.To.Width,this.Elapsed,this.Duration),this.TweeningFunction(this.From.Height,this.To.Height,this.Elapsed,this.Duration))},i}(t.Tween);t.Size2dTween=i})(n.Tweening||(n.Tweening={}));var t=n.Tweening}(EndGate||(EndGate={})),function(n){(function(n){(function(n){var t=function(){function n(){}return Object.defineProperty(n,"EaseIn",{get:function(){return n._easeIn},enumerable:!0,configurable:!0}),Object.defineProperty(n,"EaseOut",{get:function(){return n._easeOut},enumerable:!0,configurable:!0}),Object.defineProperty(n,"EaseInOut",{get:function(){return n._easeInOut},enumerable:!0,configurable:!0}),n._easeIn=function(n,t,i,r){var f=t-n,u=i.Milliseconds;return f*(u/=r.Milliseconds)*u*((1.70158+1)*u-1.70158)+n},n._easeOut=function(n,t,i,r){var f=t-n,u=i.Milliseconds;return f*((u=u/r.Milliseconds-1)*u*((1.70158+1)*u+1.70158)+1)+n},n._easeInOut=function(n,t,i,r){var e=t-n,u=i.Milliseconds,f=1.70158;return(u/=r.Milliseconds/2)<1?e/2*u*u*(((f*=1.525)+1)*u-f)+n:e/2*((u-=2)*u*(((f*=1.525)+1)*u+f)+2)+n},n}();n.Back=t})(n.Functions||(n.Functions={}));var t=n.Functions})(n.Tweening||(n.Tweening={}));var t=n.Tweening}(EndGate||(EndGate={})),function(n){(function(n){(function(n){var t=function(){function n(){}return Object.defineProperty(n,"EaseIn",{get:function(){return n._easeIn},enumerable:!0,configurable:!0}),Object.defineProperty(n,"EaseOut",{get:function(){return n._easeOut},enumerable:!0,configurable:!0}),Object.defineProperty(n,"EaseInOut",{get:function(){return n._easeInOut},enumerable:!0,configurable:!0}),n._easeIn=function(t,i,r,u){var f=i-t;return f-n.EaseOut(0,f,u.Subtract(r),u)+t},n._easeOut=function(n,t,i,r){var f=t-n,u=i.Milliseconds;return(u/=r.Milliseconds)<1/2.75?f*7.5625*u*u+n:u<2/2.75?f*(7.5625*(u-=1.5/2.75)*u+.75)+n:u<2.5/2.75?f*(7.5625*(u-=2.25/2.75)*u+.9375)+n:f*(7.5625*(u-=2.625/2.75)*u+.984375)+n},n._easeInOut=function(t,i,r,u){var f=i-t;return r.Milliseconds<u.Milliseconds/2?n.EaseIn(0,f,r.Multiply(2),u)*.5+t:n.EaseOut(0,f,r.Multiply(2).Subtract(u),u)*.5+f*.5+t},n}();n.Bounce=t})(n.Functions||(n.Functions={}));var t=n.Functions})(n.Tweening||(n.Tweening={}));var t=n.Tweening}(EndGate||(EndGate={})),function(n){(function(n){(function(n){var t=function(){function n(){}return Object.defineProperty(n,"EaseIn",{get:function(){return n._easeIn},enumerable:!0,configurable:!0}),Object.defineProperty(n,"EaseOut",{get:function(){return n._easeOut},enumerable:!0,configurable:!0}),Object.defineProperty(n,"EaseInOut",{get:function(){return n._easeInOut},enumerable:!0,configurable:!0}),n._easeIn=function(n,t,i,r){var f=t-n,u=i.Milliseconds;return-f*(Math.sqrt(1-(u/=r.Milliseconds)*u)-1)+n},n._easeOut=function(n,t,i,r){var f=t-n,u=i.Milliseconds;return f*Math.sqrt(1-(u=u/r.Milliseconds-1)*u)+n},n._easeInOut=function(n,t,i,r){var f=t-n,u=i.Milliseconds;return(u/=r.Milliseconds/2)<1?-f/2*(Math.sqrt(1-u*u)-1)+n:f/2*(Math.sqrt(1-(u-=2)*u)+1)+n},n}();n.Circular=t})(n.Functions||(n.Functions={}));var t=n.Functions})(n.Tweening||(n.Tweening={}));var t=n.Tweening}(EndGate||(EndGate={})),function(n){(function(n){(function(n){var t=function(){function n(){}return Object.defineProperty(n,"EaseIn",{get:function(){return n._easeIn},enumerable:!0,configurable:!0}),Object.defineProperty(n,"EaseOut",{get:function(){return n._easeOut},enumerable:!0,configurable:!0}),Object.defineProperty(n,"EaseInOut",{get:function(){return n._easeInOut},enumerable:!0,configurable:!0}),n._easeIn=function(n,t,i,r){var f=t-n,u=i.Milliseconds;return f*(u/=r.Milliseconds)*u*u+n},n._easeOut=function(n,t,i,r){var f=t-n,u=i.Milliseconds;return f*((u=u/r.Milliseconds-1)*u*u+1)+n},n._easeInOut=function(n,t,i,r){var f=t-n,u=i.Milliseconds;return(u/=r.Milliseconds/2)<1?f/2*u*u*u+n:f/2*((u-=2)*u*u+2)+n},n}();n.Cubic=t})(n.Functions||(n.Functions={}));var t=n.Functions})(n.Tweening||(n.Tweening={}));var t=n.Tweening}(EndGate||(EndGate={})),function(n){(function(n){(function(n){var t=function(){function n(){}return Object.defineProperty(n,"EaseIn",{get:function(){return n._easeIn},enumerable:!0,configurable:!0}),Object.defineProperty(n,"EaseOut",{get:function(){return n._easeOut},enumerable:!0,configurable:!0}),Object.defineProperty(n,"EaseInOut",{get:function(){return n._easeInOut},enumerable:!0,configurable:!0}),n._easeIn=function(n,t,i,r){var e=t-n,u=i.Milliseconds,f,o;return u===0?n:(u/=r.Milliseconds)==1?n+e:(f=r.Milliseconds*.3,o=f/4,-(e*Math.pow(2,10*(u-=1))*Math.sin((u*r.Milliseconds-o)*2*Math.PI/f))+n)},n._easeOut=function(n,t,i,r){var f=t-n,u=i.Milliseconds,e,o;return u===0?n:(u/=r.Milliseconds)==1?n+f:(e=r.Milliseconds*.3,o=e/4,f*Math.pow(2,-10*u)*Math.sin((u*r.Milliseconds-o)*2*Math.PI/e)+f+n)},n._easeInOut=function(n,t,i,r){var f=t-n,u=i.Milliseconds,e,o;return u===0?n:(u/=r.Milliseconds/2)==2?n+f:(e=r.Milliseconds*.3*1.5,o=e/4,u<1)?-.5*f*Math.pow(2,10*(u-=1))*Math.sin((u*r.Milliseconds-o)*2*Math.PI/e)+n:f*Math.pow(2,-10*(u-=1))*Math.sin((u*r.Milliseconds-o)*2*Math.PI/e)*.5+f+n},n}();n.Elastic=t})(n.Functions||(n.Functions={}));var t=n.Functions})(n.Tweening||(n.Tweening={}));var t=n.Tweening}(EndGate||(EndGate={})),function(n){(function(n){(function(n){var t=function(){function n(){}return Object.defineProperty(n,"EaseIn",{get:function(){return n._easeIn},enumerable:!0,configurable:!0}),Object.defineProperty(n,"EaseOut",{get:function(){return n._easeOut},enumerable:!0,configurable:!0}),Object.defineProperty(n,"EaseInOut",{get:function(){return n._easeInOut},enumerable:!0,configurable:!0}),n._easeIn=function(n,t,i,r){var f=t-n,u=i.Milliseconds;return u==0?n:f*Math.pow(2,10*(u/r.Milliseconds-1))+n},n._easeOut=function(n,t,i,r){var u=t-n,f=i.Milliseconds;return f==r.Milliseconds?n+u:u*(-Math.pow(2,-10*f/r.Milliseconds)+1)+n},n._easeInOut=function(n,t,i,r){var f=t-n,u=i.Milliseconds;return u==0?n:u==r.Milliseconds?n+f:(u/=r.Milliseconds/2)<1?f/2*Math.pow(2,10*(u-1))+n:f/2*(-Math.pow(2,-10*--u)+2)+n},n}();n.Exponential=t})(n.Functions||(n.Functions={}));var t=n.Functions})(n.Tweening||(n.Tweening={}));var t=n.Tweening}(EndGate||(EndGate={})),function(n){(function(n){(function(n){var t=function(){function n(){}return Object.defineProperty(n,"EaseIn",{get:function(){return n._easeIn},enumerable:!0,configurable:!0}),Object.defineProperty(n,"EaseOut",{get:function(){return n._easeOut},enumerable:!0,configurable:!0}),Object.defineProperty(n,"EaseInOut",{get:function(){return n._easeInOut},enumerable:!0,configurable:!0}),n._easeIn=function(n,t,i,r){var f=t-n,u=i.Milliseconds;return f*(u/=r.Milliseconds)*u+n},n._easeOut=function(n,t,i,r){var f=t-n,u=i.Milliseconds;return-f*(u/=r.Milliseconds)*(u-2)+n},n._easeInOut=function(n,t,i,r){var f=t-n,u=i.Milliseconds;return(u/=r.Milliseconds/2)<1?f/2*u*u+n:-f/2*(--u*(u-2)-1)+n},n}();n.Quadratic=t})(n.Functions||(n.Functions={}));var t=n.Functions})(n.Tweening||(n.Tweening={}));var t=n.Tweening}(EndGate||(EndGate={})),function(n){(function(n){(function(n){var t=function(){function n(){}return Object.defineProperty(n,"EaseIn",{get:function(){return n._easeIn},enumerable:!0,configurable:!0}),Object.defineProperty(n,"EaseOut",{get:function(){return n._easeOut},enumerable:!0,configurable:!0}),Object.defineProperty(n,"EaseInOut",{get:function(){return n._easeInOut},enumerable:!0,configurable:!0}),n._easeIn=function(n,t,i,r){var f=t-n,u=i.Milliseconds;return f*(u/=r.Milliseconds)*u*u*u+n},n._easeOut=function(n,t,i,r){var f=t-n,u=i.Milliseconds;return-f*((u=u/r.Milliseconds-1)*u*u*u-1)+n},n._easeInOut=function(n,t,i,r){var f=t-n,u=i.Milliseconds;return(u/=r.Milliseconds/2)<1?f/2*u*u*u*u+n:-f/2*((u-=2)*u*u*u-2)+n},n}();n.Quartic=t})(n.Functions||(n.Functions={}));var t=n.Functions})(n.Tweening||(n.Tweening={}));var t=n.Tweening}(EndGate||(EndGate={})),function(n){(function(n){(function(n){var t=function(){function n(){}return Object.defineProperty(n,"EaseIn",{get:function(){return n._easeIn},enumerable:!0,configurable:!0}),Object.defineProperty(n,"EaseOut",{get:function(){return n._easeOut},enumerable:!0,configurable:!0}),Object.defineProperty(n,"EaseInOut",{get:function(){return n._easeInOut},enumerable:!0,configurable:!0}),n._easeIn=function(n,t,i,r){var f=t-n,u=i.Milliseconds;return f*(u/=r.Milliseconds)*u*u*u*u+n},n._easeOut=function(n,t,i,r){var f=t-n,u=i.Milliseconds;return f*((u=u/r.Milliseconds-1)*u*u*u*u+1)+n},n._easeInOut=function(n,t,i,r){var f=t-n,u=i.Milliseconds;return(u/=r.Milliseconds/2)<1?f/2*u*u*u*u*u+n:f/2*((u-=2)*u*u*u*u+2)+n},n}();n.Quintic=t})(n.Functions||(n.Functions={}));var t=n.Functions})(n.Tweening||(n.Tweening={}));var t=n.Tweening}(EndGate||(EndGate={})),function(n){(function(n){(function(n){var t=function(){function n(){}return Object.defineProperty(n,"EaseIn",{get:function(){return n._easeIn},enumerable:!0,configurable:!0}),Object.defineProperty(n,"EaseOut",{get:function(){return n._easeOut},enumerable:!0,configurable:!0}),Object.defineProperty(n,"EaseInOut",{get:function(){return n._easeInOut},enumerable:!0,configurable:!0}),n._easeIn=function(n,t,i,r){var u=t-n,f=i.Milliseconds;return-u*Math.cos(f/r.Milliseconds*(Math.PI/2))+u+n},n._easeOut=function(n,t,i,r){var u=t-n,f=i.Milliseconds;return u*Math.sin(f/r.Milliseconds*(Math.PI/2))+n},n._easeInOut=function(n,t,i,r){var u=t-n,f=i.Milliseconds;return-u/2*(Math.cos(Math.PI*f/r.Milliseconds)-1)+n},n}();n.Sinusoidal=t})(n.Functions||(n.Functions={}));var t=n.Functions})(n.Tweening||(n.Tweening={}));var t=n.Tweening}(EndGate||(EndGate={})),function(n){var t=function(){function n(){this._type="EventHandler3",this._actions=[]}return n.prototype.Bind=function(n){this._actions.push(n)},n.prototype.BindFor=function(n,t){var i=this,r=0;this._actions.push(function(){++r>=t&&i.Unbind(n),n.apply(this,arguments)})},n.prototype.Unbind=function(n){for(var t=0;t<this._actions.length;t++)if(this._actions[t]===n){this._actions.splice(t,1);return}},n.prototype.HasBindings=function(){return this._actions.length>0},n.prototype.Trigger=function(n,t,i){var u,r;if(this.HasBindings())for(u=this._actions.slice(0),r=0;r<u.length;r++)u[r](n,t,i)},n.prototype.Dispose=function(){this._actions=[]},n}();n.EventHandler3=t}(EndGate||(EndGate={}));
//@ sourceMappingURL=endgate-0.2.0-beta1.min.js.map